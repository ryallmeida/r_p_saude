---
title: 'CURSO DE EXTENS√ÉO<br>
"R PARA SA√öDE"'
subtitle: |
  INFORM√ÅTICA APLICADA<br>
  √Ä PESQUISA CIENT√çFICA [TURMA: PJ350-2025]
author: Ryan Almeida, Maria Soares, Carla Cavalcante
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    html_document:
       highlight: textmate
       includes:
         in_header: "C:/Users/ryall/Desktop/R/r_p_saude/r_p_saude/modulos/img/header.html"
       theme: united
       number_sections: yes
       toc: yes
       toc_float:
         collapsed: yes
         smooth_scroll: no
---


```{r normas de uso}

# Aviso: Essas notas de aula s√£o exclusivas para uso como guia do curso, por√©m n√£o substituem as refer√™ncias e materiais de apoio. Quaisquer erros s√£o de responsabilidade dos autores. 
# Esse material √© protegido por ser propriedade intelectual.
# Logo, ao reproduzir, divulgar ou distribuir notifique as autorias.

# Caso encontre erros, contate os autores imediatamente. Via e-mail ryallmeida@gmail.com

```

```{r}

# CODADO ORIGINALMENTE EM R, V. 4.5.2

```

```{r Carregamento dos Pacotes, echo=FALSE, message=FALSE, warning=FALSE}

if(!require("pacman")) {
  install.packages("pacman")
}

pacman::p_load(tidyverse, 
               ggpubr, 
               patchwork,
               car,
               rstatix,
               emmeans,
               knitr,
               kableExtra,
               htmltools,
               rmarkdown)

```

# Sobre o curso e os autores {.tabset .tabset-fade}

Apostilas dos c√≥digos utilizados nas aulas "Curso: R para Sa√∫de" realizado em parceria entre o Departamento de Ci√™ncia Pol√≠tica e o Programa de P√≥s-gradua√ß√£o em Nutri√ß√£o da Universidade Federal de Pernambuco. Curso ministrado pelos docentes: [Prof.¬™ Dr.¬™ Maria Soares](http://lattes.cnpq.br/6914758127566065) e o [Prof. Dalson Britto](http://lattes.cnpq.br/6683806605359913) e monitorado por [Ryan Almeida](https://github.com/ryallmeida) e [Carla Cavalcante](https://github.com/Carla-Cavalcante)

## Maria Soares

## Ryan Almeida

## Carla Cavalcante 

## Dalson Britto

# Fundamentos em R

## Por que programar? Por que codar exatamente em R? 

Motivos para voc√™ escolher a Linguagem R

* Linguagem com desenvolvimento comunit√°rio. Logo, constatemente ela se reinventa e se adapta as possibilidades que ou a vida academica ou o mercado pedem.

* Linguagem de programa√ß√£o aberta, ent√£o qualquer pessoa pode baix√°-la e come√ßar a codar imediatamente e de gra√ßa. Diferentemente de outros Softwares pagos comos SPPS ou STATA.

* Mercado de trabalho tem deteminado algumas hardskills que voc√™ deve saber e grandes empresas est√£o cada vez mais interessados em profissionais que saibam usar R.

Bizu da madrinha: presta aten√ß√£o nesses atalhos que voc√™ certamente vai usar quando tiver codando

```{r atalho_rstudio, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

atalhos_rstudio <- data.frame(
  Atalho = c(
    "CTRL + ENTER",
    "ALT + -",
    "CTRL + SHIFT + M",
    "CTRL + 1",
    "CTRL + 2",
    "CTRL + ALT + I",
    "CTRL + SHIFT + K",
    "ALT + SHIFT + K"
  ),
  Funcao = c(
    "Executa a(s) linha(s) selecionada(s) no script",
    "Insere o operador de atribui√ß√£o (<-)",
    "Insere o operador pipe (%>%)",
    "Move o cursor para o script",
    "Move o cursor para o console",
    "Cria um chunk em um documento R Markdown",
    "Compila (renderiza) um arquivo R Markdown",
    "Abre a janela com todos os atalhos dispon√≠veis"
  ),
  stringsAsFactors = FALSE
)

knitr::kable(head(atalhos_rstudio, 10))


```

# Aplica√ß√µes com dados simulados {.tabset .tabset-fade}

## Boxplots com estat√≠sticas

```{r Boxplot, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

if(!require("pacman")) {
  install.packages("pacman")
}

pacman::p_load(tidyverse, 
               ggpubr, 
               patchwork)

set.seed(123)

n <- 180
dados <- tibble(
  id = 1:n,
  grupo = sample(c("Controle", 
                   "Interven√ß√£o A", 
                   "Interven√ß√£o B"), 
                 n, 
                 replace = TRUE),
  sexo = sample(c("Feminino",
                  "Masculino"), 
                n, 
                replace = TRUE),
  idade = round(rnorm(n, 
                      mean = 45, 
                      sd = 12)),
  energia_kcal = round(rnorm(n, 
                             mean = 2200, 
                             sd = 450)),
  protein_g = round(rnorm(n,
                          mean = 80, 
                          sd = 20)),
  fat_g = round(rnorm(n, 
                      mean = 80, 
                      sd = 25)),
  carb_g = round(rnorm(n, 
                       mean = 300, 
                       sd = 70))
)

dados <- dados %>%
  mutate(
    protein_g = case_when(
      grupo == "Controle" ~ protein_g - 3,
      grupo == "Interven√ß√£o A" ~ protein_g + 5,
      grupo == "Interven√ß√£o B" ~ protein_g + 1
    ),
    energia_kcal = case_when(
      grupo == "Controle" ~ energia_kcal,
      grupo == "Interven√ß√£o A" ~ energia_kcal - 120,
      grupo == "Interven√ß√£o B" ~ energia_kcal + 80
    )
  )

resumo_protein <- dados %>%
  group_by(grupo) %>%
  summarise(
    mean_protein = mean(protein_g),
    sd_protein = sd(protein_g),
    n = n(),
    se_protein = sd_protein / sqrt(n)
  )

p1_instagram <- ggplot(dados, aes(x = grupo, 
                                  y = protein_g, 
                                  fill = grupo)) +
  geom_boxplot(outlier.shape = NA, 
               alpha = 0.4, 
               width = 0.6) +
  geom_jitter(width = 0.15, 
              alpha = 0.6, 
              size = 1.4) +
  geom_point(data = resumo_protein, aes(x = grupo, 
                                        y = mean_protein), 
             color = "black", 
             size = 3) +
  geom_errorbar(data = resumo_protein,
                aes(x = grupo, 
                    y = mean_protein, 
                    ymin = mean_protein - se_protein, ymax = mean_protein + se_protein),
                width = 0.15, 
                color = "black", 
                size = 0.8) +
  stat_summary(fun = median, 
               geom = "point", 
               shape = 95, 
               size = 6, 
               color = "white") +
  labs(title = "",
       x = "", 
       y = "Prote√≠na (g/dia)") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none") +
  scale_fill_manual(values = c("#d85102", 
                               "#575b21", 
                               "#985612"))

print(p1_instagram)

```
<figcaption style="text-align: center;">
  <strong>Figura:</strong> Boxplots por grupo representando a distribui√ß√£o e as estat√≠sticas principais de tr√™s vari√°veis<br>
  <strong>Elabora√ß√£o pr√≥pria.</strong> Pires, Soares &amp; Cavalvante (2025).
</figcaption>

## Gr√°fico de Violino 

```{r Violino, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

df <- read.csv("https://raw.githubusercontent.com/ryallmeida/r_p_saude/refs/heads/main/database/dados_obesidade.csv")

p1 <- df %>%
  ggplot( aes(x= Gender, 
              y= Height, 
              fill= Gender)) +
  geom_violin(alpha = 0.2, 
              scale = "width") +
  geom_boxplot() +
  viridis::scale_fill_viridis(discrete = TRUE, 
                              alpha=0.6) +
  geom_jitter(color="black", 
              size=0.2, 
              alpha=0.7,
              width = 0.4,
              shape = 10) +
  theme(
    legend.position="none",
    plot.title = element_text(size=11)
  ) +
  ggtitle("") +
  xlab("") +
    labs(title = "", 
       x = "Sexo",
       y = "Peso") +
  theme_minimal(base_size = 14)+
  scale_fill_manual(values = c("#d85102", "#575b21"))

print(p1)

```

<figcaption style="text-align: center;">
  <strong>Figura:</strong> Gr√°fico de violino por g√™nero representando a distribui√ß√£o da vari√°vel peso dado o grupo<br>
  <strong>Elabora√ß√£o pr√≥pria.</strong> Pires, Soares &amp; Cavalvante (2025).
</figcaption>


## Gr√°fico de Densidade 

```{r Densidade Normalizada, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

if(!require("pacman")) {
  install.packages("pacman")
}

pacman::p_load(tidyverse, 
               psych, 
               likert, 
               table1, 
               flextable, 
               RColorBrewer, 
               viridis)

df <- read.csv("https://raw.githubusercontent.com/ryallmeida/r_p_saude/refs/heads/main/database/dados_obesidade.csv")

Height_z <- scale(df$Height)
Weight_z <- scale(df$Weight)


p3 <- ggplot(df) +
  # Altura padronizada (cima)
  geom_density(aes(x = Height_z, 
                   y = after_stat(density)/max(after_stat(density)), 
                   fill = Gender),
               alpha = 0.5, 
               color = NA) +
  viridis::scale_fill_viridis(discrete = TRUE, 
                              alpha=0.6) +
  annotate("label",
           x = 4.5,
           y = 0.25,
           label = "Altura",
           color = "black", 
           hjust = 1) +
  
  # Peso padronizado (baixo, espelhado)
  geom_density(aes(x = Weight_z, y = -after_stat(density)/max(after_stat(density)), fill = Gender),
               alpha = 0.5, 
               color = NA) + 
  viridis::scale_fill_viridis(discrete = TRUE, 
                              alpha=0.6) +
  annotate("label",
           x = 4.5,
           y = -0.25,
           label = "Peso",
           color = "black", 
           hjust = 1) +
  geom_hline(yintercept = 0) +
  labs(title = "", 
       x = "Valores padronizados (Zscore)",
       y = "Densidade normalizada") +
  theme_minimal() +
  scale_fill_manual(values = c("#d85102", "#575b21"))

print(p3)

```

<figcaption style="text-align: center;">
  <strong>Figura:</strong> Gr√°fico de densidade normalizada agrupado por sexo espelhado sob duas vari√°veis<br>
  <strong>Elabora√ß√£o pr√≥pria.</strong> Pires, Soares &amp; Cavalvante (2025).
</figcaption>


## Ajuste linear por grupo

```{r Ajuste Linear, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

p2_instagram <- ggplot(dados, aes(x = energia_kcal, y = protein_g, color = grupo)) +
  geom_point(alpha = 0.7, size = 1.8) +
  geom_smooth(method = "lm", se = TRUE, fullrange = FALSE) +
  labs(
    title = "",
    x = "Energia (kcal/dia)",
    y = "Prote√≠na (g/dia)",
    color = "Grupo"
  ) +
  theme_minimal(base_size = 14) +
  scale_color_manual(values = c("#d85102", "#575b21", "#985612"))

print(p2_instagram)

```

<figcaption style="text-align: center;">
  <strong>Figura:</strong> Energia em fun√ß√£o da prote√≠na com ajuste linear por grupo<br>
  <strong>Elabora√ß√£o pr√≥pria.</strong> Pires, Soares &amp; Cavalvante (2025).
</figcaption>
<br>
  
Esses s√£o uns dos muitos pontenciais do R. Se te convencemos a gostar dessa liguagem, continua lendo essa apostila.

# Programa√ß√£o orientada √† objetos

A linguagem R, assim como outras existentes tem como possibilidade a cria√ß√£o de objetos. Vejamos alguns exemplos simples

```{r}

valor <- 10.5678
conjunto <- c(1, 3, 5, 7)
cores <- c("azul", "vermelho")

```

Em cada exemplo, usamos o s√≠mbolo de atribui√ß√£o ("<-"). No R, tamb√©m √© poss√≠vel usar '=' com a mesma fun√ß√£o, mas n√£o aconselhamos porque as vezes pode confundir quem est√° come√ßando. 

No primeiro exemplo, temos um objeto do tipo num√©rico. No segundo e terceiro temos um vetor, pois concatena informa√ß√µes. 

√â poss√≠vel acessar os objetos criados no R. Basta usar o comando ``ls()``. E para remov√™-los caso precise desocupar slots de mem√≥ria, use:

```{r, eval=FALSE}

# COLOQUE A OBJETO QUE VOC√ä QUER REMOVER DENTRO DO PARENTESES DA rm()

rm(); gc()

```

Detalhe importante: o R √© uma linguagem q-sensitiva, ou seja, "cores' √© diferente de "Cores" (palavra com letra min√∫scula vs palavra com letra mai√∫scula). 

Outro detalhe importante: comente seus c√≥digos com #, converse consigo mesmo, pense no seu "eu do futuro" lendo um c√≥digo escrito por voc√™ no passado. Somos muito incopetentes quando come√ßamos algo novo, voc√™ pode cometer erros ao codar, e principalmente quando est√° balisando estat√≠stica e ci√™ncia de dados com programa√ß√£o. Sempre tente descrever brevemente o que est√° fazendo na linha de seu script. 

√Ål√©m disso, tamb√©m √© poss√≠vel acessar os objetos usando a fun√ß√£o print()
Note como funciona: 

```{r}

print(valor)

# OU

valor

# OU

print(valor, digits = 2)


```

## Tipos de vari√°veis em R

```{r Tipo de Vari√°veis, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

tipos_variaveis <- data.frame(
  Tipo = c(
    "Num√©ricas (numeric)",
    "Datas (Date)",
    "Categ√≥ricas (factor)",
    "Categ√≥ricas orden√°veis (ordered)",
    "Texto (character)",
    "Booleanas (logical)"
  ),
  Descricao = c(
    "N√∫meros inteiros ou reais, como idade, renda, n√∫mero de filhos.",
    "S√£o um tipo especial de vari√°vel num√©rica.",
    "Vari√°veis qualitativas para as quais n√£o √© poss√≠vel atribuir um valor num√©rico, como sexo, religi√£o, estado civil ou opini√£o.",
    "Vari√°veis categ√≥ricas cujas categorias podem ser hierarquizadas, como grau de escolaridade ou respostas ordenadas.",
    "Caracter√≠sticas puramente individuais que n√£o podem ser utilizadas para categorizar os indiv√≠duos, usadas em an√°lises qualitativas.",
    "Vari√°veis cujos valores podem ser VERDADEIRO ou FALSO; no R, TRUE ou FALSE."
  ),
  stringsAsFactors = FALSE
)

knitr::kable(head(tipos_variaveis, 10))


```

Veja algumas situa√ß√µes-problemas, que talvez te ajudem a dar luz no seu cer√©bro caso n√£o tenha entendido ainda. Imagine que voc√™ coletou dados de 5 pessoas e, para cada uma, tem as seguintes vari√°veis:

```{r situacao-problema, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

tipos_variaveis <- data.frame(
  Variavel = c(
    "idade",
    "data de uma entrevista",
    "sexo",
    "escolaridade",
    "relato de opini√£o",
    "fumante"
  ),
  Descricao = c(
    "√© o n√∫mero propriamente dito",
    "data",
    "categ√≥rica (Femino, Masculino, Outro; Voc√™ tem tr√™s categorias aqui)",
    "categ√≥rica orden√°vel (Porque voc√™ n√¢o vira doutor sem antes ter se formado no ABC)",
    "texto de um relato, por exemplo, o R vai entender como um character",
    "booleana, ou fuma ou n√£o fuma, ou TRUE ou FALSE, ou SIM ou N√ÉO, note que s√≥ existe duas possibilidades e nada mais, essa √© a ess√™ncia de uma vari√°vel booleana"
  ),
  stringsAsFactors = FALSE
)

knitr::kable(head(tipos_variaveis, 10))


```

## Operadores L√≥gico e Matem√°ticos 

```{r Operadores, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Criando um dataframe com operadores do R e seus significados
operadores <- data.frame(
  
  operador = c("+", "-", "/", "*", "^",
               ">", "<", ">=", "<=",
               "==", "!=", "&", "|", "!"),
  
  significado = c(
    "Soma",
    "Subtra√ß√£o",
    "Divis√£o",
    "Multiplica√ß√£o",
    "Exponencia√ß√£o",
    "Maior que",
    "Menor que",
    "Maior ou igual a",
    "Menor ou igual a",
    "Igual a",
    "Diferente de",
    "E (AND l√≥gico)",
    "Ou (OR l√≥gico)",
    "N√£o (nega√ß√£o l√≥gica)"
  ),
  
  tipo = c(
    rep("Aritm√©tico", 5),
    rep("Relacional", 6),
    rep("L√≥gico", 3)
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(operadores, 10))


```

### Atividade: "Use o R como calculadora"

```{r, eval=FALSE}
# DIGITE E VEJA O OUTPUT

2 + 2
4/2
2 - 1
4*2

```

```{r, eval=FALSE}
# DIGITE E VEJA O OUTPUT
# LEMBRE QUE O RESULTADO DE UM TESTE L√ìGICO √â SEMPRE UM OUTPUT BOOLEANO

3 > 2
5 < 2
(6 > 5) & (7 > 8)
(6 > 5) | (7 > 8)

```

## Vetores, tabelas, matrizes e listas

Em computa√ß√£o, √© bastante comum lidar com conjuntos de valores, como notas, pre√ßos, nomes ou qualquer outro tipo de informa√ß√£o organizada. Para tornar essa manipula√ß√£o poss√≠vel de forma eficiente, utilizam-se estruturas de dados, que permitem armazenar e acessar m√∫ltiplos valores de maneira sistem√°tica. Quando se trabalha com dados de um mesmo tipo, como n√∫meros inteiros, valores reais ou cadeias de caracteres, uma das estruturas mais fundamentais √© o vetor.

Os vetores podem ser compreendidos como **agregados homog√™neos unidimensionais**, isto √©, estruturas que re√∫nem v√°rios valores do mesmo tipo em uma √∫nica vari√°vel, organizados em uma √∫nica dimens√£o. Essa caracter√≠stica faz dos vetores a base para praticamente todas as demais estruturas de dados no R, funcionando como o elemento mais simples de organiza√ß√£o da informa√ß√£o.

As tabelas conhecidas no R como `data.frame` s√£o estruturas particularmente importantes para a an√°lise de dados. Uma tabela √© composta por m√∫ltiplos vetores de mesmo comprimento, sendo que cada vetor representa uma vari√°vel. Diferentemente das matrizes, esses vetores podem ser de tipos distintos, como num√©ricos, l√≥gicos ou caracteres. Essa flexibilidade torna as tabelas semelhantes a planilhas ou bases de dados, sendo ideais para representar dados experimentais ou observacionais. No R, a cria√ß√£o de tabelas √© realizada por meio da fun√ß√£o `data.frame()`, consolidando-as como a estrutura central para organiza√ß√£o e an√°lise de dados emp√≠ricos.

As matrizes, por sua vez, podem ser entendidas como uma extens√£o dos vetores, pois mant√™m a homogeneidade de tipo, mas permitem a organiza√ß√£o dos dados em mais de uma dimens√£o. Diferentemente dos vetores unidimensionais, as matrizes possibilitam o acesso aos dados por meio de m√∫ltiplos √≠ndices, como linhas e colunas. Conceitualmente, uma matriz pode ser pensada como um vetor cujos elementos s√£o, eles pr√≥prios, vetores, organizados de forma recursiva. Esse tipo de estrutura √© especialmente √∫til em situa√ß√µes em que √© necess√°rio correlacionar informa√ß√µes, como em c√°lculos matem√°ticos ou an√°lises estat√≠sticas.

J√° as listas representam uma estrutura mais flex√≠vel. Uma lista √© um objeto formado por uma cole√ß√£o ordenada de componentes, nos quais cada elemento pode ser de um tipo diferente. Em uma mesma lista, √© poss√≠vel reunir vetores, valores l√≥gicos, matrizes, arrays e at√© outras listas. No R, listas s√£o criadas por meio da fun√ß√£o `list()`. O acesso aos seus elementos pode ser feito tanto pelos operadores de colchetes (`[]`), que indicam a posi√ß√£o do elemento desejado, quanto pelo operador cifr√£o (`$`), que permite acessar componentes nomeados. Esses operadores n√£o se limitam √†s listas, sendo amplamente utilizados tamb√©m em matrizes, arrays e tabelas.


![](https://raw.githubusercontent.com/ryallmeida/r_p_saude/main/modulos/img/sistema_array.png){width=544px, .center}

O R √© uma linguagem que possui em sua vers√£o inicial diversos pacotes que possuem alguns tipos de fun√ß√µes. No entanto, existem muitas outras fun√ß√µes que podem ser obtidas atrav√©s de pacotes que podem ser instalados.

```{r, eval=FALSE}
# PARA INSTALAR UM NOVO PACOTE, USE A FUN√á√ÉO
install.packages("nome do pacote")

# CARREGUE O PACOTE USANDO  
library(nome do pacote) # OU
require(nome do pacote)

```

# Introdu√ß√£o √† Estat√≠stica Descritiva

O R nasce na √°rea da estat√≠stica. O potencial do R est√° justamente em unir o Data Science com toda a teoria da estat√≠stica e realizar todos os calculos complexos adjacentes √† ela. Ent√£o, n√£o podemos ser omissos e deixar de revisar o b√°sico da √°rea. 

## Mas para que serve a estat√≠stica afinal?

Deste modo, podemos definir Estat√≠stica como sendo a ci√™ncia que se preocupa com a coleta, organiza√ß√£o, apresenta√ß√£o, an√°lise e interpreta√ß√£o de dados. Didaticamente, podemos dividir a estat√≠stica em duas partes: **a estat√≠stica descritiva e a infer√™ncia estat√≠stica.**

A estat√≠stica descritiva se refere √† maneira de apresentar um conjunto de dados em tabelas e gr√°ficos, e ao modo de resumir as informa√ß√µes contidas nestes dados a algumas medidas. 

J√° a infer√™ncia estat√≠stica baseia-se na teoria das probabilidades para estabelecer conclus√µes sobre todo um grupo (chamado popula√ß√£o), quando se observou apenas uma parte (amostra) desta popula√ß√£o. 

A esse ponto, como voc√™ j√° deve saber, as caracter√≠stica de uma popula√ß√£o ou amostra s√£o denominadas vari√°veis. (Em caso de d√∫vidas, visite a sess√£o anterior para revisar esses conceitos)

## Medidas de Posi√ß√£o

As principais medidas de posi√ß√£o s√£o composta pelos "tr√™s Ms" da estat√≠stica, e certamente voc√™ ja ouviu falar deles na escola. Que s√£o a m√©dia, mediana e a moda, tamb√©m conhecidas como pedidas de tend√™ncia central (conceito sin√¥nimo ao titulo da subsses√£o). Essas resumem um conjunto de dados em um √∫nico valor central que representa a "localiza√ß√£o" ou o "ponto de equil√≠brio" dos dados, podendo ser eles os quartis e percentis outros tipos de medidas de posi√ß√£o (tambem chamados de medidas separatrizes)

### M√©dia Aritimetica

Considere uma amostra composta por $n$ observa√ß√µes num√©ricas $x_1, x_2, x_3, \dots, x_n$. A primeira medida descritiva fundamental √© a m√©dia aritm√©tica, que representa o valor central obtido ao distribuir igualmente a soma total dos dados entre todas as observa√ß√µes. Algebricamente, inicia-se somando todos os valores da amostra, o que pode ser representado pela soma $\sum_{i=1}^{n} x_i$. Em seguida, essa soma √© dividida pelo n√∫mero total de observa√ß√µes $ n$, resultando na m√©dia amostral, expressa por $\bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_i$. Do ponto de vista alg√©brico, a m√©dia pode ser interpretada como o valor constante que, se substitu√≠sse todas as observa√ß√µes individuais, preservaria exatamente a mesma soma total dos dados.

Em geral, utiliza-se $\bar{x}$ para denotar a m√©dia amostral e $\mu$ para denotar a m√©dia populacional.

No R, a m√©dia de uma amostra √© obtida por meio da fun√ß√£o `mean()`. A m√©dia √© uma medida de posi√ß√£o que √© muito afetada por **outliers**. Outliers s√£o observa√ß√µes que n√£o correspondem aos valores esperados de uma popula√ß√£o ou amostra. Em geral, s√£o valores que est√£o muito acima ou muito abaixo da maioria dos valores observados.

Mas, quais s√£o os crit√©rios que se utilizam para definir se uma observa√ß√£o √© um outlier ou n√£o? No entanto, a  resposta √©: Depende. A palavra final √© sempre do pesquisador que conhece o fen√¥meno, e pode informar se a informa√ß√£o obtida √© realmente aceit√°vel ou n√£o. Assim, de todo modo tanto na estat√≠stica descritiva quanto na inferencial √© de suma import√¢ncia entender "quem"" √© essa observa√ß√£o fora da curva e ver o quanto ela muda o resultado de descri√ß√µes e de modelos estat√≠sticos. Guarde no seu cora√ß√£o essa essa pergunta: como flutuaria as medidas de posi√ß√£o com outlier e sem outlier? A resposta dessa pergunta determina os resultados da sua pesquisa. 

Se voc√™ ainda n√£o entendeu o que √© outlier talvez essa metafora ajude: "Se uma pessoa estiver com os p√©s dentro de um forno com temperatura de 50 graus Celsius e a cabe√ßa dentro de um freezer com temperatura de zero graus na m√©dia estar√° uma temperatura agrad√°vel?" Isso faz sentido pra voc√™? Pois √©, isso √© um outlier. 

Ent√£o, se isso √© um problema t√£o grande, como confiar em pesquisas que usam unicamente da m√©dia para demonstrar o comportamento dos dados? Por esse motivo √© importante que uma medida de posi√ß√£o sempre esteja acompanhada de uma medida de dispers√£o.

### Mediana

A **mediana**, por sua vez, n√£o depende da soma dos valores, mas da posi√ß√£o relativa de cada observa√ß√£o no conjunto de dados. Para calcul√°-la, √© necess√°rio ordenar a amostra em ordem crescente, obtendo-se a sequ√™ncia $x_{(1)} \le x_{(2)} \le \dots \le x_{(n)}$. Se o n√∫mero de observa√ß√µes for √≠mpar, isto √©, $n = 2k + 1$, a mediana ser√° o elemento que ocupa a posi√ß√£o central da sequ√™ncia ordenada, dada por $x_{(k+1)}$. Caso o n√∫mero de observa√ß√µes seja par, isto √©, $n = 2k$, n√£o h√° um √∫nico valor central; nesse caso, a mediana √© definida como a m√©dia aritm√©tica dos dois valores centrais, sendo calculada como $\frac{x_{(k)} + x_{(k+1)}}{2}$. Algebricamente, a mediana pode ser entendida como o ponto que divide a distribui√ß√£o ordenada em duas partes com o mesmo n√∫mero de observa√ß√µes, independentemente da magnitude dos valores extremos.

### Moda

A **moda** √© a medida de tend√™ncia central mais simples do ponto de vista alg√©brico, pois n√£o envolve opera√ß√µes aritm√©ticas como soma ou divis√£o, mas sim a contagem de frequ√™ncias (guarda essa informa√ß√£o no cora√ß√£o). Seja $f(x_i)$ a frequ√™ncia absoluta associada ao valor $x_i$. A moda √© definida como o valor da vari√°vel que maximiza essa frequ√™ncia, podendo ser representada simbolicamente por:

$$
\text{Moda} = \arg\ max_{x_i} f(x_i) 
$$

Em termos alg√©bricos, o procedimento consiste em identificar qual valor aparece o maior n√∫mero de vezes no conjunto de dados. Dependendo da distribui√ß√£o das frequ√™ncias, o conjunto pode ser unimodal, bimodal, multimodal ou mesmo amodal, quando n√£o existe um valor com frequ√™ncia superior √†s demais.

De todo modo, d√° uma olhadinha nesse quadro de fichamento de fim de sess√£o:

```{r Medidas de Posi√ß√£o, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

indicador_adequado <- data.frame(
  Indicador_Adequado = c(
    "M√©dia",
    "Mediana",
    "Mediana", 
    "Comparar M√©dia e Mediana"
  ),
  Objetivo_da_Analise = c(
    "Avaliar impacto total, m√©dia geral ou tend√™ncia global",
    "Avaliar situa√ß√£o t√≠pica, comportamento comum, ou dados enviesados", 
    "Evitar distor√ß√µes causadas por outliers",
    "Descrever heterogeneidade"
  ),
  stringsAsFactors = FALSE
)

knitr::kable(head(indicador_adequado, 10))


```

No R, tem uma forma excelente de pedir todas essas informa√ß√µes via um comando nativo, ou como tamb√©m chamam, via R base.

```{r}
# DIGITE

x <- c(1, 5, 10, 15, 20, 25, 30, 35)
base::summary(x)

# OS OUTPUTS DO R SEMPRE SAIR√ÉO EM INGL√äS, ENT√ÉO N√ÉO SE ASSUSTE

```

### Quartis

Quartis podem ser compreendidos como ‚Äúmedidas que dividem os dados ordenados em quatro partes iguais: primeiro quartil (Q1), segundo quartil (Q2) e terceiro quartil (Q3).‚Äù

Pode-se dizer que 25% dos valores est√£o abaixo de Q1 e 75% dos valores est√£o acima de Q1. O segundo quartil √© exatamente igual √† mediana e aritmeticamente falando a diferen√ßa entr Q3 e Q1 √© chamada de amplitude interquart√≠lica. 


### Percentis

O k-√©simo percentil, denotado por Pk,√© o valor na posi√ß√£o, de forma que k% das
medidas s√£o menores que a posi√ß√£o Pk, ou seja, (100-k)% das observa√ß√µes s√£o maiores
que Pk. O k-√©simo percentil √© determinado por: Pk =  √© o valor do kn/100 ‚àí √©simo termo no conjunto de dados ordenados, onde k √© o percentil e n √© o tamanho da amostra. Para al√©m dessa defini√ß√£o formal, a gente pode compreender percentil como a divis√£o em 100 partes iguais do banco de dados. E o percentil √© a determinada unidade que voc√™ observa ou que est√° balisando em sua an√°lise. O percentil serve para voc√™ entender um comportamento de uma propor√ß√£o espec√≠fica de seus dados. Por exemplo, o c√≥digo abaixo tenta responder a seguinte hipotese: qual √© o valor abaixo do qual se encontram 0,1% das observa√ß√µes v√°lidas da vari√°vel x?


```{r, eval=FALSE}
# DIGITE 

quantile(x, probs = 0.001, type = 4, na.rm = T)


```
Em resumo, essa fun√ß√£o √© utilizada para localizar um ponto muito baixo da distribui√ß√£o dos dados (como outliers, por exemplo) ignorando valores ausentes e usando um m√©todo espec√≠fico de defini√ß√£o de quantil. Ela √© particularmente √∫til em an√°lises explorat√≥rias, diagn√≥sticos de assimetria, estudo de caudas da distribui√ß√£o e decis√µes metodol√≥gicas relacionadas √† exclus√£o ou tratamento de valores extremos. Se voc√™ estiver se perguntando, porque em termos percentuais o argumento probs est√° escrito errado, mas n√£o se preocupe, o c√°lculo desse argumento baseia-se em probabilidade n√£o em propor√ß√£o propriamente dita. 

## Medidas de Dispers√£o

### Amplitude

> ‚ÄúAmplitude √© a medida mais simples de dispers√£o e definida como sendo a diferen√ßa entre o maior e o menor valor entre os dados observados.‚Äù

A amplitude √© bastante influenciada por outliers. Por isso, n√£o  √© uma boa medida para dados que contenham outliers. Ainda, essa √© uma medida de dispers√£o que utiliza somente 2 observa√ß√µes, independente do tamanho da amostra.

### Vari√¢ncia e Desvio padr√£o

A vari√¢ncia leva em considera√ß√£o os valores extremos e os valores intermedi√°rios, isto √©, expressa melhor os resultados obtidos. A vari√¢ncia relaciona os desvios em torno da m√©dia, ou, mais especificamente, √© a m√©dia aritm√©tica dos quadrados dos desvios. Sendo a vari√¢ncia calculada a partir dos quadrados dos desvios, ela √© um n√∫mero em unidade quadrada em rela√ß√£o √† vari√°vel em quest√£o, o que, sob o ponto de vista pr√°tico, √© um inconveniente; por isso, tem pouca utilidade na estat√≠stica descritiva, mas √© extremamente importante na infer√™ncia estat√≠stica e em combina√ß√µes de amostras. 

No c√°lculo da vari√¢ncia, os valores obtidos a partir da diferen√ßa entre cada observa√ß√£o e a m√©dia podem ser chamados de **res√≠duos** ou **desvios**. Esses res√≠duos possuem uma propriedade fundamental: quando somados diretamente, o resultado √© obrigatoriamente zero. Isso ocorre porque a m√©dia aritm√©tica √© justamente o ponto de equil√≠brio da distribui√ß√£o. Diante disso, surge uma quest√£o: se a soma simples dos desvios √© sempre nula, ela n√£o pode ser utilizada para medir a dispers√£o dos dados.

A solu√ß√£o encontrada pela Estat√≠stica est√° na √°lgebra dos quadrados. Ao elevar os res√≠duos ao quadrado, elimina-se o cancelamento entre valores positivos e negativos, permitindo que todas as diferen√ßas contribuam para a medida de variabilidade. Assim, trabalha-se com a **soma dos quadrados dos res√≠duos**, que ser√° sempre um n√∫mero positivo.

No entanto, esse valor bruto (a soma dos quadrados dos res√≠duos) n√£o pode ser interpretado isoladamente. Ele n√£o possui significado substantivo direto, pois seu tamanho depende fortemente do tamanho da amostra: quanto maior o n√∫mero de observa√ß√µes, maior tende a ser essa soma, ainda que a dispers√£o relativa dos dados permane√ßa a mesma. Por isso, √© necess√°rio padronizar esse valor por meio de uma m√©dia dos quadrados dos desvios, o que nos conduz ao conceito de vari√¢ncia.

Nesse ponto, √© essencial distinguir entre vari√¢ncia amostral e vari√¢ncia populacional. A vari√¢ncia populacional considera todos os elementos da popula√ß√£o e divide a soma dos quadrados dos desvios pelo n√∫mero total de observa√ß√µes. J√° a vari√¢ncia amostral introduz um ajuste alg√©brico, dividindo essa soma por $n - 1$, de modo a corrigir o vi√©s decorrente do uso de uma amostra para estimar a variabilidade da popula√ß√£o.

O **desvio padr√£o amostral** mede o grau de dispers√£o dos dados em torno da m√©dia e envolve uma sequ√™ncia de opera√ß√µes alg√©bricas bem definidas. O primeiro passo √© calcular a m√©dia amostral $\bar{x}$. Em seguida, calcula-se, para cada observa√ß√£o, o desvio em rela√ß√£o √† m√©dia, dado por $x_i - \bar{x}$. Esses desvios s√£o ent√£o elevados ao quadrado, resultando em $(x_i - \bar{x})^2$, o que evita o cancelamento alg√©brico dos desvios positivos e negativos, j√° que a soma dos desvios simples em rela√ß√£o √† m√©dia √© sempre igual a zero. O passo seguinte consiste em somar todos os desvios quadr√°ticos, obtendo-se $\sum_{i=1}^{n} (x_i - \bar{x})^2$. Essa soma √© ent√£o dividida por $n - 1$, e n√£o por $n$, como forma de corrigir o vi√©s decorrente do fato de a m√©dia ter sido estimada a partir da pr√≥pria amostra, o que implica a perda de um grau de liberdade. 

Esse quociente define a vari√¢ncia amostral, $s^2=\frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2$. Por fim, toma-se a raiz quadrada da vari√¢ncia para retornar √† mesma unidade de medida dos dados originais, obtendo-se o desvio padr√£o amostral, expresso por $s = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n} (x_i - \bar{x})^2}$. Dessa forma, o desvio padr√£o sintetiza, de maneira alg√©brica e conceitual, o qu√£o afastados os valores da amostra est√£o, em m√©dia, da m√©dia aritm√©tica.

Por fim, o desvio padr√£o fornece uma medida de dispers√£o das observa√ß√µes ao redor da
m√©dia.  Um desvio padr√£o pequeno indica que os dados possuem uma amplitude pequena ao redor da m√©dia. J√°, um desvio padr√£o grande, indica que os dados possuem uma amplitude grande ao redor da m√©dia.

### Assimetria

Denomina-se assimetria o grau de afastamento de uma distribui√ß√£o em rela√ß√£o √† simetria perfeita.
Quando representamos uma distribui√ß√£o por meio de um histograma ou de um pol√≠gono de frequ√™ncia, estamos, na pr√°tica, observando a forma com que os dados se organizam em torno de um valor central.

Em uma distribui√ß√£o sim√©trica, o lado esquerdo e o lado direito da curva s√£o espelhos um do outro. Isso implica algo muito forte: a m√©dia √© igual a mediana e igual a moda (mas n√£o se assuste que na pr√°tica √© rarissimo isso acontecer). Ou seja, todas as no√ß√µes de centralidade coincidem.

Porque analisar essa assimetria (ou simetria raramente) importa? Porque muitas t√©cnicas estat√≠sticas assumem simetria (especialmente a normalidade em alguns modelos da estat√≠sitica inferencial); porque a m√©dia deixa de ser representativa quando a distribui√ß√£o √© muito assim√©trica; porque pol√≠ticas p√∫blicas, an√°lises sociais e indicadores podem ser distorcidos por poucos valores extremos; porque a assimetria revela tend√äncias e padr√µes, como concentra√ß√£o ou distor√ß√£o estrutural nos dados.

Em termos simples: a assimetria nos diz se a ‚Äúa maioria das observa√ß√µes vive perto do centro‚Äù ou se ‚Äúpoucos puxam tudo para um lado‚Äù.

Desde cedo, os estat√≠sticos perceberam que duas distribui√ß√µes podem ter a mesma m√©dia e, ainda assim, apresentarem comportamentos completamente distintos quando observadas graficamente por meio de um histograma ou de um pol√≠gono de frequ√™ncias (como demonstra o gr√°fico abaixo). Essa diferen√ßa n√£o est√° na posi√ß√£o central, mas na forma da curva, isto √©, no modo como os valores se afastam para a esquerda ou para a direita. √â exatamente esse afastamento que se convencionou chamar de assimetria.

```{r, include=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

set.seed(123)

# Distribui√ß√£o sim√©trica
x_simetrica <- rnorm(1000, mean = 50, sd = 10)

# Distribui√ß√£o assim√©trica positiva
x_assimetrica <- rexp(1000, rate = 1/50)

# For√ßando as duas a terem exatamente a mesma m√©dia
mean(x_simetrica)
mean(x_assimetrica)


```
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}


par(mfrow = c(1, 2))

p4 <- hist(
  x_simetrica,
  freq = FALSE,
  col = "lightgray",
  main = "Distribui√ß√£o Sim√©trica",
  xlab = "Valores",
  ylab = "Densidade",
  border = "white"
)

abline(
  v = mean(x_simetrica),
  col = "black",
  lwd = 2
)

text(
  mean(x_simetrica),
  0.03,
  "M√©dia",
  col = "black",
  pos = 4
)

p5 <- hist(
  x_assimetrica,
  freq = FALSE,
  col = "lightgray",
  main = "Distribui√ß√£o Assim√©trica",
  xlab = "Valores",
  ylab = "Densidade",
  border = "white"
)
abline(
  v = mean(x_assimetrica),
  col = "black",
  lwd = 2
)
text(
  mean(x_assimetrica),
  0.03,
  "M√©dia",
  col = "black",
  pos = 4
)


print(p4)
print(p5)

par(mfrow = c(1, 1))

```

Na pr√°tica, a maioria das distribui√ß√µes observadas em dados sociais, econ√¥micos ou de sa√∫de apresenta algum grau de deforma√ß√£o, sendo, portanto, assim√©trica.

Foi nesse contexto que Karl Pearson buscou uma forma de quantificar a assimetria, transformando uma percep√ß√£o visual em uma medida num√©rica objetiva. A ideia central de Pearson era simples e engenhosa: se, em distribui√ß√µes sim√©tricas, m√©dia, mediana e moda coincidem, ent√£o o afastamento entre essas medidas poderia ser utilizado como um indicador do grau e da dire√ß√£o da assimetria.

A primeira abordagem de Pearson parte da compara√ß√£o entre a m√©dia e a moda. Ele observa que, em distribui√ß√µes assim√©tricas √† direita, a cauda longa empurra a m√©dia para valores maiores, enquanto a moda permanece pr√≥xima ao pico da distribui√ß√£o. J√° nas distribui√ß√µes assim√©tricas √† esquerda, ocorre o movimento oposto: a m√©dia √© puxada para valores menores. Assim, a diferen√ßa entre a m√©dia e a moda,carrega informa√ß√£o direta sobre a dire√ß√£o da assimetria. No entanto, Pearson reconhece rapidamente uma limita√ß√£o: essa diferen√ßa depende da escala dos dados. Um mesmo formato de distribui√ß√£o pode gerar valores muito distintos apenas por mudan√ßa de unidade de medida. Para resolver esse problema, Pearson recorre a uma estrat√©gia cl√°ssica da Estat√≠stica: a padroniza√ß√£o. Ao dividir a diferen√ßa entre m√©dia e moda pelo desvio padr√£o 
$s$, ele obt√©m uma medida adimensional, compar√°vel entre diferentes conjuntos de dados. Dessa forma, surge o chamado Primeiro Coeficiente de Assimetria de Pearson, definido como

\[
AS_1 = \frac{\bar{x} - Mo}{s}
\]

Esse coeficiente n√£o apenas indica a presen√ßa de assimetria, mas tamb√©m sua dire√ß√£o: valores positivos indicam assimetria √† direita, enquanto valores negativos indicam assimetria √† esquerda.

Apesar de conceitualmente elegante, o primeiro coeficiente enfrenta uma dificuldade pr√°tica importante: a moda nem sempre √© facilmente identific√°vel, especialmente em distribui√ß√µes cont√≠nuas ou em amostras pequenas. Diante disso, Pearson prop√µe uma alternativa baseada na mediana, uma medida sempre bem definida e menos sens√≠vel a valores extremos.

A solu√ß√£o se apoia em uma rela√ß√£o emp√≠rica amplamente observada em distribui√ß√µes moderadamente assim√©tricas, segundo a qual a moda pode ser aproximada por

\[
Mo \approx 3Md - 2\bar{x}
\]

Ao substituir essa aproxima√ß√£o na express√£o original do coeficiente, a diferen√ßa entre m√©dia e moda transforma-se em

\[
\bar{x} - Mo 
= \bar{x} - (3Md - 2\bar{x}) 
= \bar{x} - 3Md + 2\bar{x} 
= 3\bar{x} - 3Md 
= 3(\bar{x} - Md)
\]

Novamente, para eliminar o efeito da escala, Pearson divide essa express√£o pelo desvio padr√£o, obtendo o Segundo Coeficiente de Assimetria de Pearson:

\[
AS_2 = \frac{3(\bar{x} - Md)}{s}
\]

Esse segundo coeficiente se torna particularmente popular por sua facilidade de aplica√ß√£o e por dispensar o c√°lculo da moda.

A interpreta√ß√£o dos coeficientes de Pearson √© direta e intuitiva. Quando o coeficiente de assimetria √© igual a zero, conclui-se que a distribui√ß√£o √© sim√©trica. Valores positivos indicam assimetria positiva, ou seja, uma cauda mais longa √† direita da distribui√ß√£o, situa√ß√£o em que se observa a rela√ß√£o (Moda < Mediana < M√©dia). Por outro lado, valores negativos indicam assimetria negativa, caracterizada por uma cauda mais longa √† esquerda, com a ordena√ß√£o (M√©dia < Mediana < Moda)

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

set.seed(123)

par(mfrow = c(1, 3))

x_pos <- rexp(1000, 
              rate = 0.1)

hist(
  x_pos,
  freq = FALSE,
  col = "lightgray",
  main = "Assimetria Positiva (√† direita)",
  xlab = "Valores"
)

abline(v = mean(x_pos), 
       col = "black", 
       lwd = 2)
abline(v = median(x_pos), 
       col = "gray40", 
       lwd = 2, 
       lty = 2)


x_simetrico <- rnorm(1000, 
                     mean = 50, 
                     sd = 10)

hist(
  x_simetrico,
  freq = FALSE,
  col = "lightgray",
  border = "white",
  main = "Distribui√ß√£o Sim√©trica",
  xlab = "Valores",
  ylab = "Densidade",
  panel.first = grid(col = "gray85", 
                     lty = "dotted")
)

abline(v = mean(x_simetrico),   
       col = "black",    
       lwd = 2)
abline(v = median(x_simetrico), 
       col = "gray40",   
       lwd = 2, lty = 2)

legend(
  "topright",
  legend = c("M√©dia", 
             "Mediana"),
  col    = c("black", 
             "gray40"),
  lwd    = 2,
  lty    = c(1, 2),
  bty    = "n"
)

x_neg <- -rexp(1000, 
               rate = 0.1)

hist(
  x_neg,
  freq = FALSE,
  col = "lightgray",
  main = "Assimetria Negativa (√† esquerda)",
  xlab = "Valores"
)

abline(v = mean(x_neg), 
       col = "black", 
       lwd = 2)
abline(v = median(x_neg), 
       col = "gray40", 
       lwd = 2, 
       lty = 2)


par(mfrow = c(1, 1))

```

### Curtose {.tabset .tabset-fade}

A curtose √© uma medida descritiva que indica como a massa de probabilidade de uma distribui√ß√£o se organiza em torno do centro quando comparada a uma distribui√ß√£o de refer√™ncia, tradicionalmente a curva normal. Mais do que ‚Äúpico alto ou baixo‚Äù, a curtose informa como os dados se concentram no centro e nas caudas, permitindo avaliar se a distribui√ß√£o √© mais aberta, mais achatada ou mais concentrada do que o padr√£o normal. Analisar a curtose √© importante porque distribui√ß√µes com m√©dias e desvios padr√£o id√™nticos podem apresentar comportamentos substantivamente distintos quanto √† ocorr√™ncia de valores extremos, o que tem implica√ß√µes diretas para infer√™ncia estat√≠stica

#### Classifica√ß√µes da curtose

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}


set.seed(123)

n <- 10000

# Distribui√ß√µes
mesocurtica  <- rnorm(n, mean = 0, sd = 1)     # Normal
platicurtica <- runif(n, min = -3, max = 3)    # Uniforme
leptocurtica <- rt(n, df = 3)                  # t-Student

coef_curtose <- function(x) {
  Q1  <- quantile(x, 0.25)
  Q3  <- quantile(x, 0.75)
  P10 <- quantile(x, 0.10)
  P90 <- quantile(x, 0.90)
  
  K <- (Q3 - Q1) / (2 * (P90 - P10))
  return(K)
}

coef_curtose(mesocurtica)
coef_curtose(platicurtica)
coef_curtose(leptocurtica)

dens_meso  <- density(mesocurtica)
dens_plat  <- density(platicurtica)
dens_lepto <- density(leptocurtica)

par(mfrow = c(1, 3))

plot(density(mesocurtica),
     main = "Mesoc√∫rtica",
     xlab = "",
     ylab = "Densidade")

plot(density(platicurtica),
     main = "Platic√∫rtica",
     xlab = "",
     ylab = "Densidade")

plot(density(leptocurtica),
     main = "Leptoc√∫rtica",
     xlab = "",
     ylab = "Densidade")

```


#### Demonstra√ß√£o alg√©brica 

Uma forma particularmente robusta de medir a curtose √© por meio de quantis, o que reduz a sensibilidade da medida a outliers extremos. Considere uma amostra de tamanho $n$, ordenada de forma crescente como

$$
x_{(1)} \le x_{(2)} \le \cdots \le x_{(n)}
$$

A partir dessa ordena√ß√£o, definem-se os quartis e percentis que servir√£o de base para o coeficiente de curtose. O primeiro quartil, denotado por Q1, corresponde ao percentil 25 da distribui√ß√£o, enquanto o terceiro quartil, Q3, corresponde ao percentil 75.

A diferen√ßa entre o terceiro quartil e o primeiro quartil, mede a amplitude interquart√≠lica, que representa a dispers√£o dos dados na regi√£o central da distribui√ß√£o.

De forma complementar, consideram-se os percentis mais afastados do centro: o percentil 10, e o percentil 90. A diferen√ßa entre o percentil 90 e o percentil 10 expressa a dispers√£o associada √†s caudas da distribui√ß√£o, isto √©, aos valores relativamente extremos, mas ainda est√°veis do ponto de vista estat√≠stico. O coeficiente de curtose baseado em quantis √© ent√£o definido pela raz√£o entre a dispers√£o central e a dispers√£o das caudas, devidamente normalizada, sendo expresso por

$$
K = \frac{Q_3 - Q_1}{2\,(P_{90} - P_{10})}
$$

Algebricamente, essa raz√£o compara quanto os dados se espalham no centro em rela√ß√£o ao quanto se espalham nos extremos. O fator 2 no denominador atua como um ajuste de escala que permite a compara√ß√£o direta com a distribui√ß√£o normal.

A partir desse coeficiente, estabelece-se uma classifica√ß√£o objetiva das distribui√ß√µes quanto ao seu grau de curtose. Quando o valor de $K$ √© aproximadamente igual a 0,263, diz-se que a distribui√ß√£o √© mesoc√∫rtica, isto √©, apresenta um equil√≠brio entre concentra√ß√£o central e caudas semelhante ao da curva normal. Quando ùêæ > 0,263, a dispers√£o central √© relativamente maior do que a dispers√£o nas caudas, caracterizando uma distribui√ß√£o platic√∫rtica, mais achatada e aberta do que a normal. Por outro lado, quando ùêæ < 0,263, a dispers√£o central √© relativamente menor do que a dispers√£o nas caudas, indicando uma distribui√ß√£o leptoc√∫rtica, mais afilada no centro e com maior peso relativo nas caudas.


#### Compara√ß√£o dos comportamento

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

dens_meso  <- density(mesocurtica)
dens_plat  <- density(platicurtica)
dens_lepto <- density(leptocurtica)

plot(
  dens_meso,
  lwd = 2,
  main = "",
  xlab = "Valores",
  ylab = "Densidade"
)

lines(dens_plat,  lwd = 2, lty = 2)
lines(dens_lepto, lwd = 2, lty = 3)

legend(
  "topright",
  legend = c(
    "Mesoc√∫rtica (Normal)",
    "Platic√∫rtica (Uniforme)",
    "Leptoc√∫rtica (t-Student)"
  ),
  lwd = 2,
  lty = c(1, 2, 3),
  bty = "n"
)


```


# Um summary mais pontente

Lembra de quando usamos a fun√ß√£o summary do R base? Pois √©, tem formas mais robustas de pedir informa√ß√µes mais completas. D√° uma olhada no comando que segue. 

```{r}
# DIGITE

if(!require("psych")) {
  install.packages("psych")
}

x <- c(1, 5, 10, 15, 20, 25, 30, 35)
psych::describe(x)

# ESSE PACOTE √â VOLTADO PARA PESQUISADORES DA PSICOLOGIA REALIZAREM ALGUMAS T√âCNICAS DE  PSICOMETRIA. ENTRETANTO, A FUN√á√ÉO describe() √â MUITO MAIS POTENTE DO QUE FUN√á√ïES NATIVAS DO R.

# NOTAS PARA INTERPRETA√á√ÉO DO OUTPUT
# Vars     POSI√á√ÉO DA VARI√ÅVEL
# n        N√öMERO DE OBSERVA√á√ïES
# mean     M√âDIA
# sd       DESVIO PADR√ÉO
# median   MEDIANA
# trimmed  MEDIA APARADA [INTERVALO ENTRE O PERCENTIL 10 E 90]
# mad      DESVIO ABSOLUTO MEDIANO
# min      OBSERVA√á√ÉO MINIMA
# max      OBSERVA√á√ÉO M√ÅXIMA
# range    AMPLITUDE TOTAL
# skew     ASSIMETRIA DA DISTRIBUI√á√ÉO
# kurtosis CURTOSE EM EXCESSO [CURTOSE - 3]
# se       ERRO PADR√ÉO

```

# Plottagem em R base

A visualiza√ß√£o de dados √© uma etapa fundamental e cr√≠tica em diversas √°reas de an√°lise, como estat√≠stica, qu√≠mica, f√≠sica e biologia.

No contexto da estat√≠stica, a visualiza√ß√£o √© a chave para construir a intui√ß√£o necess√°ria sobre o conjunto de dados. √â a partir dessa intui√ß√£o visual que o analista pode escolher o teste estat√≠stico ou modelo matem√°tico mais adequado para resolver o problema em quest√£o.

As visualiza√ß√µes podem variar em complexidade, indo desde:

* Medidas Resumo Simples: Como frequ√™ncia, m√©dia, vari√¢ncia, desvio padr√£o, m√≠nimo, m√°ximo, entre outras.

* Tabelas: Onde um conjunto dessas medidas √© organizado de forma estruturada.

* Gr√°ficos: Representa√ß√µes visuais de (uma parte) dos dados, que permitem identificar padr√µes, outliers e distribui√ß√µes.

> Segundo o estat√≠stico norte-americano Leland Wil-kinson, ‚Äúum gr√°fico √© o mapeamento dos dados a partir de atributos est√©ticos (como posi√ß√£o, cor, forma, tamanho) de objetos geom√©tricos (pontos, linhas, barras, caixas)‚Äù (WILKINSON, 2005).

## Gr√°fico de dispers√£o 

No ambiente de programa√ß√£o R, o comando mais simples e b√°sico para criar um gr√°fico a partir de dois objetos (ou vari√°veis a depender do contexto) do tipo num√©rico √© o ```plot()```.

Este tipo de representa√ß√£o gr√°fica √© popularmente conhecido como gr√°fico de dispers√£o (ou `*scatter plot*`). Ele √© ideal para visualizar a rela√ß√£o ou a correla√ß√£o entre duas vari√°veis quantitativas. Fa√ßa o exemplo que segue no seu computador.

```{r}
# DIGITE

x <- c(1, 5, 10, 15, 20, 25, 30, 35)
y <- c(8, 16, 14, 21, 38, 25, 43, 39)

```


```{r, eval=FALSE, warning=FALSE, message=FALSE}

?plot 

# ISSO √â VOC√ä PERINDO AJUDA PARA ENTENDER A FUN√á√ÉO. VOC√ä PODE FAZER ISSO SEMPRE QUE N√ÉO SE LEMBRAR DIREITO DE UM COMANDO. 
# A PARTE RUIM √â QUE VOC√ä TEM QUE SABER INGL√äS, J√Å A PARTE BOA √â QUE VOC√™ APRENDE INGL√äS NO PROCESSO

```

```{r, fig.align="center"}

# GR√ÅFICO DE DISPERS√ÉO 

plot(y ~ x)

```

```{r, eval=FALSE, warning=FALSE, message=FALSE}

plot(x, y) 

# EM R, EXISTE IN√öMERAS FORMAS DE FAZER O MESMO COMANDO. EXEMPLO DISSO √â O C√ìDIGO ACIMA QUE √â EQUIVALENTE A FUN√á√ÉO SUPRACITADA

```

Conhe√ßa a seguir os principais argumentos da fun√ß√£o ``plot()``, o que a literatura chama de "par√¢metros de visualiza√ß√£o gr√°fica"

## Par√¢metros de visualiza√ß√£o da fun√ß√£o plot

```{r Parametros, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Criando um dataframe com par√¢metros gr√°ficos do R base
parametros_graficos <- data.frame(
  
  parametro = c("col", "pch", "type", "cex", "lty",
                "xlim", "ylim", "xlab", "ylab", "main"),
  
  descricao = c(
    "Cor dos elementos do gr√°fico (nome, n√∫mero ou rgb())",
    "Tipo de caractere/s√≠mbolo dos pontos",
    "Tipo de gr√°fico (pontos, linhas, ambos etc.)",
    "Tamanho do caractere ou ponto",
    "Tipo de linha",
    "Limites do eixo x (horizontal)",
    "Limites do eixo y (vertical)",
    "T√≠tulo do eixo x",
    "T√≠tulo do eixo y",
    "T√≠tulo principal do gr√°fico"
  ),
  
  funcao_visual = c(
    "Est√©tica",
    "Forma",
    "Estrutura",
    "Escala visual",
    "Estilo",
    "Escala do eixo",
    "Escala do eixo",
    "Rotulagem",
    "Rotulagem",
    "Narrativa"
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(parametros_graficos, 10))


```

<br>

Quando abrimos a fun√ß√£o `plot()` no R e nos deparamos com argumentos como `col`, `pch`, `cex` ou `xlim`, a sensa√ß√£o inicial √© quase sempre a de arbitrariedade: por que esses nomes? por que t√£o curtos? por que em ingl√™s? A provoca√ß√£o que vale ser feita, no entanto, √© outra: **e se esses par√¢metros n√£o forem meros atalhos t√©cnicos, mas a materializa√ß√£o de uma gram√°tica t√©cnico-cient√≠fica espec√≠fica?** 

Comecemos pela cor. `col`, abrevia√ß√£o de *color*, n√£o √© um detalhe est√©tico secund√°rio, mas um operador sem√¢ntico. Ao escolher uma cor, o pesquisador estabelece hierarquias visuais, produz contrastes e direciona o olhar do leitor. A cor, portanto, n√£o adorna o dado; ela o interpreta. O mesmo vale para `pch`, que vem de *plotting character*, um resqu√≠cio hist√≥rico da √©poca em que gr√°ficos eram impressos com caracteres tipogr√°ficos. Ainda que hoje pare√ßa anacr√¥nico, o termo revela algo fundamental: cada ponto em um gr√°fico √© um signo, um caractere que representa uma observa√ß√£o (ou amostra, a depender do contexto). Mudar o s√≠mbolo √© mudar a forma como a observa√ß√£o se apresenta ao usu√°rio/interlocutor.

<br>
<br>
<figure style="text-align: center;">
  <figcaption>
    **Figura:** Signo e c√≥digo dos plotting character no R 
  </figcaption>
</figure>
```{r pch, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Vetor com os valores de pch
pch_vals <- 0:25

# Coordenadas para posicionar os s√≠mbolos
x <- rep(1:6, length.out = length(pch_vals))
y <- rep(5:1, each = 6)[1:length(pch_vals)]

# Criando o gr√°fico vazio
plot(x, y,
     type = "n",
     axes = FALSE,
     xlab = "",
     ylab = "",
     main = "")

# Adicionando os s√≠mbolos
points(x, y,
       pch = pch_vals,
       cex = 2)

# Adicionando os r√≥tulos com o n√∫mero do pch
text(x, y - 0.3,
     labels = pch_vals,
     cex = 0.9)



```
<figure style="text-align: center;">
  <figcaption>
    Fonte: **Elabora√ß√£o pr√≥pria.** Pires, Soares & Cavalvante (2025).
  </figcaption>
</figure>
<br>
<br>
<br>

A escolha do `type` (pontos, linhas ou ambos) explicita ainda mais essa dimens√£o ontol√≥gica da visualiza√ß√£o. Pontos sugerem observa√ß√µes discretas; linhas insinuam continuidade, processo, trajet√≥ria. Trata-se de uma tomada de posi√ß√£o anal√≠tica: **o fen√¥meno que estou observando √© pontual ou processual?** O R obriga o pesquisador a responder a essa pergunta, ainda que de forma impl√≠cita.

<br>
<br>
<br>
<figure style="text-align: center;">
  <figcaption>
    **Figura:** Signo e c√≥digo do argumento type no R 
  </figcaption>
</figure>
```{r type, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Dados de exemplo
x <- 1:10
y <- c(2, 3, 5, 4, 6, 7, 8, 7, 9, 10)

# Organizando a √°rea gr√°fica
par(mfrow = c(3, 3),     # 3 linhas x 3 colunas
    mar = c(3, 3, 3, 1)) # margens mais compactas

# 1. Pontos
plot(x, y,
     type = "p",
     main = 'type = "p" (points)',
     xlab = "", ylab = "",
     pch = 16)

# 2. Linhas
plot(x, y,
     type = "l",
     main = 'type = "l" (lines)',
     xlab = "", ylab = "")

# 3. Ambos (pontos + linhas)
plot(x, y,
     type = "b",
     main = 'type = "b" (both)',
     xlab = "", ylab = "",
     pch = 16)

# 4. Apenas linhas (sem pontos vis√≠veis)
plot(x, y,
     type = "c",
     main = 'type = "c" (lines only)',
     xlab = "", ylab = "")

# 5. Pontos e linhas sobrepostos
plot(x, y,
     type = "o",
     main = 'type = "o" (overplotted)',
     xlab = "", ylab = "",
     pch = 16)

# 6. Linhas verticais
plot(x, y,
     type = "h",
     main = 'type = "h" (vertical lines)',
     xlab = "", ylab = "")

# 7. Degraus (step function)
plot(x, y,
     type = "s",
     main = 'type = "s" (steps)',
     xlab = "", ylab = "")

# 8. Degraus (varia√ß√£o)
plot(x, y,
     type = "S",
     main = 'type = "S" (steps ‚Äì alternative)',
     xlab = "", ylab = "")

# 9. N√£o plota pontos (gr√°fico vazio)
plot(x, y,
     type = "n",
     main = 'type = "n" (no plotting)',
     xlab = "", ylab = "")

# Resetando o layout
par(mfrow = c(1, 1))



```
<figure style="text-align: center;">
  <figcaption>
    Fonte: **Elabora√ß√£o pr√≥pria.** Pires, Soares & Cavalvante (2025).
  </figcaption>
</figure>
<br>
<br>
<br>


Outros par√¢metros refor√ßam esse car√°ter decis√≥rio. `cex`, de *character expansion*, controla o tamanho dos s√≠mbolos e textos. Varia numa escala continua de zero a um determinado n√∫mero muito grande, as refer√™ncias indicam n√£o colocar um valor maior que 3. Assim, ao ampliar ou reduzir um ponto, o pesquisador sinaliza relev√¢ncia. O mesmo se aplica a `lty`, de *line type*: linhas cont√≠nuas, tracejadas ou pontilhadas comunicam distin√ß√µes, compara√ß√µes, cen√°rios. 

<br>
<br>
<br>
<figure style="text-align: center;">
  <figcaption>
    **Figura:** Evid√™ncias de flutua√ß√µes nos par√¢metros do argumento cex no R 
  </figcaption>
</figure>
```{r Ocex, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Dados de exemplo
x <- 1:10
y <- x

# Valores de cex a serem comparados
cex_vals <- c(0.5, 0.8, 1, 1.5, 2, 3)

# Organizando a √°rea gr√°fica
par(mfrow = c(2, 3),      # 2 linhas x 3 colunas
    mar = c(3, 3, 3, 1))  # margens compactas

# Loop para gerar os gr√°ficos
for (i in cex_vals) {
  plot(x, y,
       pch = 16,
       cex = i,
       main = paste("cex =", i),
       xlab = "",
       ylab = "")
}

# Resetando o layout
par(mfrow = c(1, 1))



```
<figure style="text-align: center;">
  <figcaption>
    Fonte: **Elabora√ß√£o pr√≥pria.** Pires, Soares & Cavalvante (2025).
  </figcaption>
</figure>
<br>
<br>
<br>

Talvez onde essa dimens√£o pol√≠tica da visualiza√ß√£o se torne mais evidente seja nos limites dos eixos. `xlim` e `ylim`, abrevia√ß√µes de *x limits* e *y limits*, definem onde a narrativa gr√°fica come√ßa e termina. Controlar os limites √© controlar a escala; controlar a escala √© controlar a percep√ß√£o. Um mesmo conjunto de dados pode parecer est√°vel ou dram√°tico dependendo desses par√¢metros. O R, ao exigir que esses limites sejam explicitados quando necess√°rio, exp√µe um ponto crucial: **n√£o existe gr√°fico neutro**.

```{r Experimento de visualiza√ß√£o, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Dados de exemplo: tend√™ncia suave e realista
x <- 1:10
y <- c(10, 11, 11.5, 12, 12.2, 12.5, 13, 13.2, 13.5, 14)

# Organizando a √°rea gr√°fica
par(mfrow = c(1, 3),
    mar = c(4, 4, 4, 1))

# Gr√°fico HONESTO (escala adequada)
plot(x, y,
     type = "b",
     pch = 16,
     ylim = c(9, 15),
     main = "Escala adequada",
     xlab = "Tempo",
     ylab = "Indicador")

#  Gr√°fico EXAGERADO (ylim muito estreito)
plot(x, y,
     type = "b",
     pch = 16,
     ylim = c(12, 14),
     main = "Escala comprimida\n(exagera a varia√ß√£o)",
     xlab = "Tempo",
     ylab = "Indicador")

#  Gr√°fico DILU√çDO (ylim muito amplo)
plot(x, y,
     type = "b",
     pch = 16,
     ylim = c(0, 50),
     main = "Escala ampliada\n(dilui a varia√ß√£o)",
     xlab = "Tempo",
     ylab = "Indicador")

# Resetando o layout
par(mfrow = c(1, 1))


```
<br><br>

No gr√°fico acima, o que se faz √© um **experimento controlado de visualiza√ß√£o**: os dados permanecem rigorosamente os mesmos em todos os gr√°ficos, e a √∫nica coisa que varia s√£o os **limites do eixo y**, definidos pelo argumento `ylim`. Isso permite isolar o efeito da escala gr√°fica sobre a interpreta√ß√£o, mostrando que a mudan√ßa de leitura n√£o vem dos n√∫meros, mas da forma como eles s√£o enquadrados.

O primeiro bloco do c√≥digo define os dados. O vetor `x` representa uma sequ√™ncia temporal simples, enquanto `y` cont√©m valores que crescem de maneira gradual e cont√≠nua. N√£o h√° saltos bruscos nem quebras estruturais; trata-se de uma tend√™ncia suave.

No primeiro gr√°fico, o argumento `ylim = c(9, 15)` define um intervalo vertical ligeiramente maior do que o intervalo real dos dados. O resultado √© uma visualiza√ß√£o proporcional, em que o crescimento aparece de forma moderada e coerente com os valores observados. Esse gr√°fico funciona como um ponto de refer√™ncia: ele mostra o fen√¥meno sem exageros nem minimiza√ß√µes, permitindo uma leitura equilibrada da tend√™ncia.

No segundo gr√°fico, o `ylim` √© comprimido para `c(12, 14)`. Como a varia√ß√£o dos dados ocupa quase todo o espa√ßo vertical dispon√≠vel, pequenas diferen√ßas entre os valores s√£o amplificadas visualmente. A curva parece √≠ngreme, quase explosiva, mesmo que os incrementos reais sejam modestos. O c√≥digo, portanto, demonstra como uma simples altera√ß√£o de escala pode induzir uma interpreta√ß√£o alarmista, sem que nenhum dado tenha sido modificado.

No terceiro gr√°fico, ocorre o movimento inverso. O `ylim = c(0, 50)` cria um eixo vertical excessivamente amplo em rela√ß√£o aos valores observados. Nesse contexto, a mesma tend√™ncia de crescimento praticamente desaparece: a linha parece quase horizontal, sugerindo estabilidade ou insignific√¢ncia. Mais uma vez, os dados s√£o id√™nticos; o que muda √© apenas a moldura gr√°fica que os cont√©m.

Por fim, para finalizar essa parte dos par√¢metros de visualiza√ß√£o os r√≥tulos e o t√≠tulo (`xlab`, `ylab` e `main`) s√≥ se usa quando necess√°rio, visto que muitas vezes esses dados s√£o inseridos diretamente nos artigos cient√≠ficos.  

### Atividade: "Fa√ßa seu pr√≥prio gr√°fico"

```{r, eval=FALSE}
# DIGITE O QUE SEGUE E TESTE DIFERENTES PAR√ÇMETROS DE VISUALIZA√á√ÉO GR√ÅFICA

plot(x, y,
     col = "blue",
     pch = 1,
     type = "p",
     cex = 1.0,
     lty = 1,
     xlim = c(0, 45),
     ylim = c(0, 50),
     xlab = "Vari√°vel X",
     ylab = "Vari√°vel Y",
     main = "T√≠tulo que voc√™ desejar aqui"
       )

```

## Par√¢metros de visualiza√ß√£o da fun√ß√£o legend

A fun√ß√£o `legend()` funciona em conjunto com o com a fun√ß√£o `plot()`

```{r Parametros da fonte, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Criando um dataframe com par√¢metros gr√°ficos da fun√ß√£o legend() do R base
parametros_legend <- data.frame(
  
  parametro = c(
    "x, y",
    "legend",
    "ncol",
    "title",
    "horiz",
    "col",
    "pch",
    "lty",
    "lwd",
    "bty"
  ),
  
  descricao = c(
    "Posi√ß√£o da legenda no gr√°fico (ex.: 'bottomright', 'top', 'center', etc.)",
    "Texto exibido na legenda",
    "N√∫mero de colunas da legenda",
    "T√≠tulo da legenda",
    "Se TRUE, a legenda √© exibida horizontalmente",
    "Cor dos pontos ou linhas na legenda",
    "Tipo de s√≠mbolo (ponto) exibido na legenda",
    "Tipo de linha exibida na legenda",
    "Espessura da linha exibida na legenda",
    "Tipo da caixa ao redor da legenda ('o' = com caixa, 'n' = sem caixa)"
  ),
  
  funcao_visual = c(
    "Posicionamento",
    "Rotulagem",
    "Estrutura",
    "Narrativa",
    "Orienta√ß√£o",
    "Est√©tica",
    "Forma",
    "Estilo",
    "Escala visual",
    "Estrutura"
  ),
  
  stringsAsFactors = FALSE
)

# Exibindo a tabela
knitr::kable(head(parametros_legend, 10))

```

## Mudando a tipo de letra, cor e "grid"

O grid aos que n√£o conhecem √© uma grade regular que fica no fundo do gr√°fico. Auxilia na visualiza√ß√£o das coordenadas de um ponto particular. E adicionado ao gr√°fico pelo argumento panel.first

```{r Parametros Grid, echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

# Criando um dataframe com par√¢metros de fonte, cor do texto e grid no R base
parametros_texto_grid <- data.frame(
  
  parametro = c(
    "font",
    "font.axis",
    "font.lab",
    "font.main",
    "col",
    "col.axis",
    "col.lab",
    "col.main",
    "col.sub",
    "fg",
    "panel.first (grid)",
    "nx, ny",
    "col (grid)",
    "lty (grid)",
    "lwd (grid)"
  ),
  
  descricao = c(
    "Tipo de fonte usada no texto do gr√°fico (1 = padr√£o, 2 = negrito, 3 = it√°lico, 4 = negrito e it√°lico)",
    "Tipo de fonte do texto dos eixos",
    "Tipo de fonte dos nomes (r√≥tulos) dos eixos",
    "Tipo de fonte do t√≠tulo principal",
    "Cor geral do texto e dos elementos do gr√°fico",
    "Cor do texto dos eixos",
    "Cor dos nomes (r√≥tulos) dos eixos",
    "Cor do texto do t√≠tulo principal",
    "Cor do texto do subt√≠tulo (se houver)",
    "Cor das linhas dos eixos do gr√°fico",
    "Argumento usado para adicionar o grid antes de desenhar os dados",
    "N√∫mero de c√©lulas do grid nas dire√ß√µes x e y",
    "Cor das linhas do grid",
    "Tipo de linha do grid",
    "Espessura das linhas do grid"
  ),
  
  funcao_visual = c(
    "Tipografia",
    "Tipografia",
    "Tipografia",
    "Tipografia",
    "Est√©tica",
    "Est√©tica",
    "Est√©tica",
    "Narrativa",
    "Narrativa",
    "Estrutura",
    "Estrutura",
    "Escala espacial",
    "Est√©tica",
    "Estilo",
    "Escala visual"
  ),
  
  stringsAsFactors = FALSE
)

# Exibindo a tabela
knitr::kable(head(parametros_texto_grid, 15))


```

### Atividade: Fa√ßa seu pr√≥prio gr√°fico 

Tente criar nove gr√°ficos do mesmo conjunto de dados, alterando par√¢metros gr√°ficos com par(), para visualizar claramente como os par√¢metros de visualiza√ß√£o alteram a narrativa dos dados plottados, mesmo sem mudar os dados. Explique, se poss√≠vel, nove hist√≥rias diferentes. 

```{r, eval=FALSE}
# DIGITE

# Dados de exemplo

x <- 1:10
y <- c(2, 4, 3, 6, 7, 9, 8, 10, 9, 11)

par(mfrow = c(3, 3))  # 3 linhas, 3 colunas

plot(
  x, y,
  type = "b",
  pch = 19,
  col = "darkblue",
  lty = 1,
  lwd = 2,
  cex = 1.3,
  xlim = c(0, 11),
  ylim = c(0, 12),
  main = "Gr√°fico personalizado",
  xlab = "",
  ylab = "",
  
  # Tipografia
  font.main = 2,
  font.lab  = 3,
  font.axis = 1,
  
  # Cores do texto
  col.main = "darkred",
  col.lab  = "darkgreen",
  col.axis = "black",
  
  # Grid com panel.first
  panel.first = grid(
    nx  = NULL,
    ny  = NULL,
    col = "lightgray",
    lty = "dotted",
    lwd = 1
  )
)

legend(
  x = "bottomright",
  legend = "Legenda",
  col = "darkblue",
  pch = 19,
  lty = 1,
  lwd = 2,
  title = "Legenda",
  horiz = FALSE,
  bty = "n"
)

par(mfrow = c(1, 1))  # 1 linha, 1 colunas


```

## Boxplot

Outro gr√°fico extremamente famoso √© o boxplot, ou tamb√©m conhecido como gr√°fico de caixas (tradu√ß√£o do termo anterior)

<br><br><br>

<figure style="text-align: center;">

  <img 
    src="https://fernandafperes.com.br/blog/interpretacao-boxplot/g2.png" 
    alt="Boxplot mostrando a distribui√ß√£o de dados."
    style="width: 50%;">

  <figcaption>
    <strong>Figura:</strong> Boxplot representando a distribui√ß√£o e as estat√≠sticas principais de uma vari√°vel<br>
    Fonte: <a href="https://fernandafperes.com.br/" target="_blank">Fernanda Peres</a>
  </figcaption>

</figure>

<br><br><br>


```{r, echo=FALSE}
# DIGITE

x <- c(1, 5, 10, 15, 20, 25, 30, 35)
y <- c(8, 16, 14, 21, 38, 25, 43, 39)

```

```{r, eval=FALSE}

# PARA PLOTAR UM BOXPLOT SEMELHANTE AO ACIMA USE O QUE SEGUE
boxplot(y)

```

```{r, echo=FALSE, fig.align="center"}

# PARA PLOTAR UM BOXPLOT SEMELHANTE AO ACIMA USE O QUE SEGUE

boxplot(y)

```

## Histograma

```{r, fig.align="center"}
# USE

hist(y)

```

# Conjunto de Dados, testes de hipotese e Introdu√ß√£o √† Regress√£o Linear 

## Conjunto de Dados

Como usar um data.frame() ? 

```{r, echo=FALSE}

# DIGITE

dados_imc <- data.frame(
  Faixa_etaria = c(
    "10‚Äì19 anos", "20‚Äì29 anos", "30‚Äì39 anos", "40‚Äì49 anos",
    "50‚Äì59 anos", "60‚Äì69 anos", "70‚Äì79 anos", "80+ anos"
  ),
  IMC_medio = c(221, 246, 261, 273, 278, 269, 258, 249),
  Consumo_frutas = c(23, 20, 19, 18, 19, 21, 24, 25),
  Taxa_obesidade = c(87, 142, 195, 231, 250, 218, 186, 157)
)


```

```{r, echo=FALSE}

# DIGITE

knitr::kable(head(dados_imc, 8))

```

Como acessar elementos de um data.frame? Use a estrutura que segue: nome_do__objeto$variavel

```{r}

# DIGITE

dados_imc$Faixa_etaria

dados_imc$IMC_medio

dados_imc$Consumo_frutas

dados_imc$Taxa_obesidade

```
Como remover informa√ß√µes do banco de dados? Suponha que, por algum motivo, n√£o queiramos que a tabela gerada pelo R apresente indiv√≠duos que tenham mais de 80 anos. No exemplo acima, precisamos retirar a oitava linha:


```{r}

# DIGITE

dados_imc <- dados_imc[-8,]

# BIZU DA MADRINHA: ANTES DA VIRGULA REPRESENTA AS OBSERVA√á√ïES E DEPOIS DA LINHA REPRESENTAM AS COLUNAS

```

```{r, echo=FALSE}

# DIGITE

knitr::kable(head(dados_imc, 8))

```     

## Testes de Hip√≥teses

H0 ‚ü∂ Hip√≥tese que nega a exist√™ncia de rela√ß√£o entre as vari√°veis
Ha(1) ‚ü∂ Hip√≥tese que se op√µe a hip√≥tese nula

Exemplo:
Ho ‚ü∂n√£o h√° mudan√ßa significativa devido ao plano alimentar
Ha ‚ü∂ o plano alimentar reduz o n√≠vel de colesterol LDL.

Mas como comparar essas duas hip√≥teses? Em qual devemos acreditar? A resposta est√° no p-value (ou no portugu√™s, p-valor). Essa medida estat√≠stica, determina a probabilidade de se obter um resultado igual ou mais extremo do que aquele observado na amostra, assumindo que a hip√≥tese nula √© verdadeira. Quando o p-valor √© baixo, a hip√≥tese nula deve ser rejeitada, para um n√≠vel de signific√¢ncia estat√≠stica de 5%. 

<br>
<br>
```{r, echo=FALSE}

tabela_pvalor <- data.frame(
  Comparacao_pvalor = c(
    "p-valor ‚â§ 0,01",
    "p-valor ‚â§ 0,05",
    "p-valor ‚â§ 0,1"
  ),
  
  Nivel_Significancia = c(
    "Altamente significativo",
    "Significativo",
    "Marginalmente significativo"
  ),
  
  Interpretacao_Resultado = c(
    "Fortes evid√™ncias contra H0",
    "Evid√™ncias contra H0",
    "Algumas evid√™ncias contra H0"
  ),
  
  Confianca_Rejeitar_H0 = c(
    "Muita confian√ßa",
    "Confian√ßa",
    "Pouca confian√ßa"
  ),
  
  stringsAsFactors = FALSE
)



knitr::kable(head(tabela_pvalor, 8))

``` 

<br>
```{r, echo=FALSE}

tabela_pvalor_nao_e <- data.frame(
  Item = 1:7,
  
  Afirmacao = c(
    "O p-valor n√£o indica a probabilidade de que a hip√≥tese nula seja verdadeira.",
    "O p-valor n√£o indica que os resultados foram produzidos aleatoriamente.",
    "O p-valor n√£o indica o tamanho do efeito observado.",
    "O p-valor n√£o mensura a import√¢ncia substantiva dos resultados observados.",
    "O p-valor n√£o deve ser interpretado sozinho quando houver outras ferramentas dispon√≠veis.",
    "O p-valor n√£o deve ser interpretado quando os pressupostos de seu c√°lculo forem violados.",
    "O p-valor n√£o deve ser interpretado quando se trabalha com a popula√ß√£o (pois o teste de hip√≥tese √© sobre amostras)."
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(tabela_pvalor_nao_e, 8))

``` 
<br>

## Introdu√ß√£o √† Regress√£o Linear

Um m√©todo para modelar o relacionamento entre duas ou mais vari√°veis e serve para prever a vari√°vel resposta (y) com base nos valores das vari√°veis preditoras (x), a fim de quantificar a for√ßa dessa rela√ß√£o. Entretanto, qual √© a hip√≥tese da regress√£o linear? 

Um exemplo poss√≠vel na √°rea da sa√∫de: existe uma associa√ß√£o estatisticamente significativa entre a ingest√£o di√°ria de s√≥dio (vari√°vel preditora) e os n√≠veis de press√£o arterial sist√≥lica (vari√°vel resposta) em um grupo de pacientes? Objetivo: Determinar se os dados fornecem evid√™ncias de que o s√≥dio √© um fator a ser considerado no manejo da hipertens√£o. Se a evid√™ncia for fraca, pode-se argumentar que, para aquele grupo, o foco deve estar em outros fatores.

A equa√ß√£o

$$
\hat{Y}_i = \hat{\beta}_0 + \sum_{j=1}^{k} \hat{\beta}_j X_{ji} + \varepsilon_i
$$

representa um **modelo de regress√£o linear m√∫ltipla** e descreve como o valor estimado de uma vari√°vel dependente √© explicado por um conjunto de vari√°veis independentes.

Em primeiro lugar, $\hat{Y}_i$ indica o valor estimado da vari√°vel resposta para o indiv√≠duo (ou observa√ß√£o) $i$. Trata-se do resultado que o modelo prev√™ com base nas informa√ß√µes dispon√≠veis, e n√£o do valor observado diretamente nos dados. O uso do ‚Äúchap√©u‚Äù (^) sinaliza que se trata de uma estimativa produzida pelo modelo estat√≠stico.

O termo $\hat{\beta}_0$ √© o intercepto da regress√£o. Ele representa o valor esperado de $Y$ quando todas as vari√°veis explicativas $X_{ji}$ assumem valor zero. Em termos substantivos, o intercepto pode ser interpretado como um ponto de refer√™ncia ou condi√ß√£o basal, ainda que, em muitos contextos emp√≠ricos, essa situa√ß√£o (todas as vari√°veis iguais a zero) n√£o seja realista. Mesmo assim, o intercepto √© fundamental para posicionar corretamente a reta (ou hiperplano) de regress√£o.

O somat√≥rio

$$
\sum_{j=1}^{k} \hat{\beta}_j X_{ji}
$$

expressa a contribui√ß√£o conjunta das $k$ vari√°veis independentes para explicar Y. Cada coeficiente $\hat{\beta}_j$ indica o efeito m√©dio associado √† vari√°vel $X_j$, mantendo todas as demais constantes. Em termos interpretativos, $\hat{\beta}_j$ informa quanto se espera que $\hat{Y}_i$ varie quando $X_{ji}$ aumenta uma unidade, assumindo que as outras vari√°veis do modelo n√£o se alterem. Assim, os coeficientes capturam rela√ß√µes parciais, e n√£o efeitos brutos ou isolados.

O termo $\varepsilon_i$ representa o erro aleat√≥rio ou res√≠duo associado √† observa√ß√£o i. Ele corresponde √† parcela de $Y_i$ que n√£o √© explicada pelas vari√°veis inclu√≠das no modelo. Em termos substantivos, o erro agrega fatores n√£o observados, imprecis√µes de medida e varia√ß√µes aleat√≥rias inevit√°veis nos fen√¥menos sociais e emp√≠ricos.

Ao interpretar o resultado de uma regress√£o linear, o foco recai principalmente sobre os coeficientes $\hat{\beta}_j$, seus sinais (positivos ou negativos), suas magnitudes e sua signific√¢ncia estat√≠stica. Um coeficiente positivo indica uma associa√ß√£o direta entre a vari√°vel explicativa e a vari√°vel dependente; um coeficiente negativo indica uma associa√ß√£o inversa. A signific√¢ncia estat√≠stica, por sua vez, informa se o efeito estimado √© suficientemente distinto de zero para que n√£o seja atribu√≠do apenas ao acaso, dado um n√≠vel de confian√ßa pr√©-estabelecido.

Al√©m dos coeficientes individuais, a regress√£o deve ser interpretada de forma global, observando-se medidas de ajuste do modelo, como o $R^2$, que indica a propor√ß√£o da vari√¢ncia de (Y) explicada pelo conjunto das vari√°veis independentes. Em conjunto, esses elementos permitem avaliar tanto a for√ßa explicativa do modelo quanto a plausibilidade substantiva das rela√ß√µes estimadas.

### Principais pressupostos da Regress√£o Linear

N√£o esque√ßa: a viola√ß√£o dos pressupostos da regress√£o pode levar a estimativas enviesadas, erros-padr√£o incorretos, testes t e f inv√°lidos, e conclus√µes estat√≠sticas equivocadas.

<br>

```{r, echo=FALSE}

tabela_pressupostos <- data.frame(
  Pressuposto = c(
    "Linearidade",
    "Aus√™ncia de erro de mensura√ß√£o",
    "A expectativa da m√©dia do termo de erro √© igual a zero",
    "Homocedasticidade",
    "Aus√™ncia de autocorrela√ß√£o",
    "A vari√°vel independente n√£o deve ser correlacionada com o termo de erro",
    "Nenhuma vari√°vel teoricamente relevante para explicar Y foi deixada de fora do modelo e nenhuma vari√°vel irrelevante para explicar Y foi inclu√≠da no modelo (Correta Especifica√ß√£o)",
    "Aus√™ncia de multicolinearidade",
    "Distribui√ß√£o normal do termo de erro",
    "Propor√ß√£o adequada entre casos e vari√°veis"
  ),
  
  `O que acontece se ele for violado?` = c(
    "Erro de especifica√ß√£o do modelo (forma funcional equivocada). Os coeficientes ser√£o inconsistentes (enviesados e ineficientes).",
    "Diversos problemas podem surgir, desde inefici√™ncia at√© vi√©s, a depender do tipo de erro (aleat√≥rio ou sistem√°tico) e do local do erro (vari√°vel dependente e/ou independente).",
    "O intercepto do modelo ser√° afetado.",
    "Estimativas inconsistentes (inefici√™ncia). N√£o poderemos confiar nos testes de signific√¢ncia.",
    "Inconsist√™ncia dos testes de signific√¢ncia (intervalos de confian√ßa e p-valor ser√£o prejudicados).",
    "Estimativas inconsistentes (vi√©s).",
    "Estimativas inconsistentes. Vi√©s e inefici√™ncia. Pior cen√°rio do mundo.",
    "Inconsist√™ncia dos testes de signific√¢ncia (intervalos de confian√ßa e p-valor ser√£o prejudicados).",
    "Estimativas inconsistentes. Depende da natureza do problema. Poder√£o ocorrer vi√©s e/ou inefici√™ncia.",
    "Inefici√™ncia. Testes de signific√¢ncia ser√£o muito inst√°veis. Quanto menor a amostra, pior."
  ),
  
  `O que pode ser feito?` = c(
    "Adotar outra forma funcional. Transformar as vari√°veis.",
    "Usar modelos de equa√ß√µes estruturais. Estimar indicadores compostos (an√°lise fatorial). Utilizar outras vari√°veis com maior n√≠vel de validade e confiabilidade.",
    "Procurar ajuda na literatura sobre o tema em quest√£o com o objetivo de garantir que todas as vari√°veis teoricamente relevantes foram inclu√≠das no modelo e que nenhuma vari√°vel irrelevante foi considerada.",
    "Utilizar corre√ß√µes estat√≠sticas para melhorar a qualidade das estimativas.",
    "Diferentes modalidades de autocorrela√ß√£o exigem tratamentos distintos. No caso da autocorrela√ß√£o serial, o mais adequado √© utilizar modelos de s√©ries temporais.",
    "Garantir correta especifica√ß√£o do modelo. Utilizar vari√°veis instrumentais.",
    "Garantir correta especifica√ß√£o do modelo.",
    "Verificar a codifica√ß√£o e a transforma√ß√£o das vari√°veis. Aumentar o tamanho da amostra. Utilizar alguma t√©cnica de redu√ß√£o de dados. Melhorar especifica√ß√£o do modelo.",
    "Aumentar o tamanho da amostra.",
    "Aumentar a quantidade de observa√ß√µes. Melhorar a especifica√ß√£o do modelo. Reduzir a quantidade de vari√°veis independentes."
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(tabela_pressupostos, align = "l")

```

<br>

### Ser√° que dieta melhora a sa√∫de? 

Vamos testar essa hip√≥tese utilizando o m√©todo da regress√£o linear estimado por m√≠nimos quadrados ordin√°rios para modular a rela√ß√£o entre as v√°ri√°veis "Score de Sa√∫de" e "√çndice de Qualidade de Vida" que pertence ao banco de dados "Health and Lifestyle Data for Regression". Baixe-o baixe diretamente na fonte em [Kaggle](https://www.kaggle.com/datasets/pratikyuvrajchougule/health-and-lifestyle-data-for-regression?resource=download)

```{r}

# VAMOS TESTAR, USE OS DADOS QUE SEGUEM

bd <- read.csv("https://raw.githubusercontent.com/ryallmeida/r_p_saude/refs/heads/main/database/synthetic_health_data.csv")

# D√Å UMA OLHADA NO BANCO DE DADOS

```

```{r, echo=FALSE}

library(rmarkdown)
paged_table(dados)

```


```{r, echo=FALSE, fig.align='center'}


# PLOT INICIAL SEM LINHA DE REGRESS√ÉO
plot(bd$Diet_Quality, bd$Health_Score, ylab = "Health score", xlab = "Indice qualidade da dieta")


```

```{r}

# O MODELO DE REGRESS√ÉO SEGUE O SEGUINTE COMANDO
modelo <- lm(Health_Score ~ Diet_Quality, data = bd) 

# ACESSE OS RESULTADOS DO MODELO DA SEGUINTE FORMA
summary(modelo)

```

## M√©todo dos M√≠nimos Quadrados Ordin√°rios {.tabset .tabset-fade}

O M√©todo dos M√≠nimos Quadrados Ordin√°rios (MQO) √© o fundamento matem√°tico e estat√≠stico que permite transformar um conjunto de dados observados em um modelo linear estimado. A sua import√¢ncia decorre do fato de que ele fornece um crit√©rio claro, operacional e teoricamente justificado para escolher os coeficientes $\beta_0, \beta_1, \ldots, \beta_k$ que melhor descrevem a rela√ß√£o entre as vari√°veis.

A primeira express√£o

$$
\min_{\beta_0, \beta_1, \dots, \beta_k}\sum_{i=1}^{n}\left( Y_i - \beta_0 - \sum_{j=1}^{k} \beta_j X_{ji} \right)^2
$$

define o **problema de otimiza√ß√£o central do MQO**. O que se busca √© encontrar os valores dos par√¢metros que minimizam a soma dos quadrados dos res√≠duos. O termo entre par√™nteses representa a diferen√ßa entre o valor observado (Y_i) e o valor ajustado pelo modelo linear. Ao elevar essa diferen√ßa ao quadrado, o m√©todo garante que erros positivos e negativos n√£o se anulem e, ao mesmo tempo, penaliza erros grandes de forma mais severa do que erros pequenos. Assim, o MQO escolhe os coeficientes que produzem, no conjunto, o **melhor ajuste m√©dio poss√≠vel** aos dados.

A import√¢ncia dessa minimiza√ß√£o est√° no fato de que ela fornece uma **regra objetiva** para estimar os par√¢metros. N√£o se trata de um ajuste visual ou arbitr√°rio, mas de uma solu√ß√£o √∫nica (sob condi√ß√µes padr√£o) derivada de um crit√©rio matem√°tico expl√≠cito. Em termos geom√©tricos, o MQO projeta o vetor de valores observados (Y) sobre o espa√ßo gerado pelas vari√°veis explicativas, garantindo que os res√≠duos sejam ortogonais a esse espa√ßo. Isso confere ao modelo uma propriedade central: n√£o h√° informa√ß√£o linear adicional nas vari√°veis explicativas que possa reduzir ainda mais os erros.

A segunda express√£o

$$
\hat{\varepsilon}_i = Y_i - \hat{\beta}_0 - \sum_{j=1}^{k} \hat{\beta}_j X_{ji}
$$

define o res√≠duo estimado para cada observa√ß√£o. O res√≠duo mede exatamente aquilo que o modelo n√£o consegue explicar. A import√¢ncia desse termo √© dupla. Primeiro, ele permite avaliar a qualidade do ajuste, pois res√≠duos pequenos indicam que o modelo descreve bem os dados, enquanto res√≠duos grandes sugerem omiss√µes, m√° especifica√ß√£o ou alta variabilidade n√£o explicada. Segundo, os res√≠duos s√£o a base para toda a infer√™ncia estat√≠stica associada √† regress√£o: testes de hip√≥teses, intervalos de confian√ßa e diagn√≥sticos do modelo dependem diretamente do seu comportamento.

Do ponto de vista te√≥rico, o MQO √© especialmente importante porque, sob hip√≥teses relativamente fracas (linearidade, exogeneidade, vari√¢ncia constante e aus√™ncia de multicolinearidade perfeita), os estimadores obtidos possuem propriedades desej√°veis. Eles s√£o n√£o viesados, consistentes e, pelo Teorema de Gauss‚ÄìMarkov, apresentam a menor vari√¢ncia poss√≠vel entre todos os estimadores lineares n√£o viesados. Isso significa que, dentro dessa classe, nenhum outro m√©todo produz estimativas mais precisas em m√©dia.

Al√©m disso, o MQO cria uma ponte direta entre √°lgebra, geometria e estat√≠stica aplicada. Ele pode ser interpretado como um problema de minimiza√ß√£o, como uma proje√ß√£o em espa√ßos vetoriais ou como um procedimento inferencial probabil√≠stico. 

Em s√≠ntese, a import√¢ncia dos M√≠nimos Quadrados Ordin√°rios reside em tr√™s aspectos centrais: ele fornece um crit√©rio matem√°tico rigoroso para estimar coeficientes, permite quantificar sistematicamente o erro por meio dos res√≠duos e garante propriedades estat√≠sticas √≥timas sob condi√ß√µes bem definidas. 


```{r, echo=FALSE, fig.align='center'}

plot(bd$Diet_Quality, bd$Health_Score, ylab = "Health score", xlab = "Indice qualidade da dieta")

# PLOTA LINHA DE REGRESS√ÉO
abline(modelo, col = "red", lwd = 3.5)

# ADICIONA OS PRINCIPAIS RESULTADOS DIRETAMENTE AO GR√ÅFICO
intercepto <- round(coef(modelo)[1], 2)
coeficiente <- round(coef(modelo)[2], 2)
r2 <- round(summary(modelo)$r.squared, 3)
p_valor <- round(summary(modelo)$coefficients[2, 4], 4)

legend("topleft",
       legend = c(
         paste("Intercepto =", intercepto),
         paste("Coeficiente =", coeficiente),
         paste("R^2 =", r2),
         paste("p-valor =", format.pval(p_valor, digits = 3))
       ),
       bty = "n",
       text.col = "blue",
       cex = 0.8)

```

### Modelo com R2 alto

```{r, echo=FALSE, fig.align='center'}

# -----------------------------
# 1. Gerando dados simulados
# -----------------------------
set.seed(123)

x <- 1:100
y <- 2 + 0.8 * x + rnorm(100, mean = 0, sd = 2)

# -----------------------------
# 2. Ajustando o modelo OLS
# -----------------------------
modelo <- lm(y ~ x)

# -----------------------------
# 3. Plot dos dados
# -----------------------------
plot(x, y,
     pch = 16,
     col = "black",
     xlab = "Variavel independente (x)",
     ylab = "Variavel dependente (y)",
     main = "")

# -----------------------------
# 4. Reta de regress√£o
# -----------------------------
abline(modelo, col = "red", lwd = 3)

# -----------------------------
# 5. Desenhando os res√≠duos
# -----------------------------
y_hat <- fitted(modelo)

segments(x0 = x, y0 = y,
         x1 = x, y1 = y_hat,
         col = "gray")

# -----------------------------
# 6. Legenda explicativa
# -----------------------------
legend("topleft",
       legend = c(
         "Observacoes",
         "Reta de regressao (OLS)",
         "Residuos (erros)"
       ),
       col = c("black", "red", "gray"),
       pch = c(16, NA, NA),
       lwd = c(NA, 3, 1),
       lty = c(NA, 1, 1),
       bty = "n")


```

### Modelo de R2 mais baixo

```{r, echo=FALSE, fig.align='center'}

# -----------------------------
# 1. Gerando dados simulados
# -----------------------------
set.seed(123)

x <- runif(200, min = 0, max = 100)
y <- 2 + 0.8 * x + rnorm(200, 0, 10)

# -----------------------------
# 2. Ajustando o modelo OLS
# -----------------------------
modelo <- lm(y ~ x)

# -----------------------------
# 3. Plot dos dados
# -----------------------------
plot(x, y,
     pch = 16,
     col = "black",
     xlab = "Variavel independente (x)",
     ylab = "Variavel dependente (y)",
     main = "")

# -----------------------------
# 4. Reta de regress√£o
# -----------------------------
abline(modelo, col = "red", lwd = 3)

# -----------------------------
# 5. Desenhando os res√≠duos
# -----------------------------
y_hat <- fitted(modelo)

segments(x0 = x, y0 = y,
         x1 = x, y1 = y_hat,
         col = "gray")

# -----------------------------
# 6. Legenda explicativa
# -----------------------------
legend("topleft",
       legend = c(
         "Observacoes",
         "Reta de regressao (OLS)",
         "Residuos (erros)"
       ),
       col = c("black", "red", "gray"),
       pch = c(16, NA, NA),
       lwd = c(NA, 3, 1),
       lty = c(NA, 1, 1),
       bty = "n")


```


# Anexo: tradu√ß√µes de pacotes utilizados {.tabset .tabset-fade}

Cf. Nota dos autores sobre as tradu√ß√µes dos respectivos pacotes [^1]

[^1]: Traduzido por Ryan Almeida, com o aux√≠lio de Intelig√™ncia Artificial, como parte da monitoria do ‚ÄúCurso de Extens√£o - R para Sa√∫de: Inform√°tica Aplicada √† Pesquisa Cient√≠fica‚Äù ocorrido entre os dias 3 e 7 de novembro de 2025 no Programa de P√≥s-Gradua√ß√£o em Nutri√ß√£o da Universidade Federal de Pernambuco. Uso exclusivo para sala de aula. Reprodu√ß√£o n√£o recomendada.

## {NHANES} NHANES 

### Descri√ß√£o

Estes s√£o dados de pesquisa coletados pelo National Center for Health Statistics (NCHS) dos Estados Unidos, que conduz uma s√©rie de levantamentos sobre sa√∫de e nutri√ß√£o desde o
in√≠cio da d√©cada de 1960. Desde 1999, aproximadamente 5.000 indiv√≠duos de todas as idades s√£o entrevistados anualmente em suas casas e realizam exames de sa√∫de em centros m√≥veis de exame (Mobile Examination Centers ‚Äî MECs). Conjunto de dados em formato data frame, contendo vers√µes brutas e reamostradas dos dados do NHANES. Veja abaixo os detalhes e descri√ß√µes das vari√°veis.

### Detalhes

A popula√ß√£o-alvo do NHANES √© ‚Äúa popula√ß√£o civil residente n√£o institucionalizada dos Estados
Unidos‚Äù. O NHANES (Pesquisa Nacional de Sa√∫de e Nutri√ß√£o dos EUA) utiliza um desenho amostral complexo, que super-representa certas subpopula√ß√µes, como minorias raciais. Uma an√°lise ing√™nua dos dados originais do NHANES pode levar a conclus√µes erradas ‚Äî por exemplo, as propor√ß√µes de cada grupo racial nos dados s√£o diferentes das propor√ß√µes reais da popula√ß√£o.

Os conjuntos NHANES e NHANESraw incluem 75 vari√°veis para os anos de amostragem 2009‚Äì2010
e 2011‚Äì2012. O NHANESraw cont√©m 20.293 observa√ß√µes dessas vari√°veis, al√©m de quatro vari√°veis
adicionais que descrevem o esquema de pondera√ß√£o da amostra. O NHANES cont√©m 10.000 linhas de dados reamostrados de NHANESraw para corrigir os efeitos da superamostragem.

Assim, o NHANES pode ser tratado, para fins educacionais, como se fosse uma amostra aleat√≥ria simples da popula√ß√£o americana. Uma lista das vari√°veis e descri√ß√µes segue abaixo, com links para a documenta√ß√£o original do NHANES.

### Vari√°veis do estudo


```{r, echo=FALSE}

dicionario_variaveis <- data.frame(
  Categoria = c(
    # Identifica√ß√£o
    rep("Identifica√ß√£o", 2),
    
    # Vari√°veis Demogr√°ficas
    rep("Vari√°veis Demogr√°ficas", 10),
    
    # Medidas F√≠sicas
    rep("Medidas F√≠sicas", 8),
    
    # Vari√°veis de Sa√∫de
    rep("Vari√°veis de Sa√∫de", 8),
    
    # Vari√°veis de Estilo de Vida
    rep("Vari√°veis de Estilo de Vida", 7)
  ),
  
  Variavel = c(
    # Identifica√ß√£o
    "SurveyYr", "ID",
    
    # Demogr√°ficas
    "Gender", "Age", "AgeDecade", "AgeMonths",
    "Race1 / Race3", "Education", "MaritalStatus",
    "HHIncome / HHIncomeMid", "Poverty",
    "HomeRooms / HomeOwn",
    
    # Medidas F√≠sicas
    "Weight", "Height / Length", "HeadCirc", "BMI",
    "BMICatUnder20yrs / BMI_WHO",
    "Pulse / BPSysAve / BPDiaAve",
    "BPSys1‚Äì3 / BPDia1‚Äì3",
    "Testosterone",
    
    # Sa√∫de
    "DirectChol / TotChol",
    "UrineVol1‚Äì2 / UrineFlow1‚Äì2",
    "Diabetes / DiabetesAge",
    "HealthGen",
    "DaysPhysHlthBad / DaysMentHlthBad",
    "LittleInterest / Depressed",
    "nPregnancies / nBabies / PregnantNow / Age1stBaby",
    "SleepHrsNight / SleepTrouble",
    
    # Estilo de Vida
    "PhysActive / PhysActiveDays",
    "TVHrsDay / CompHrsDay",
    "Alcohol12PlusYr / AlcoholDay / AlcoholYear",
    "Smoke100 / SmokeNow / SmokeAge",
    "Marijuana / AgeFirstMarij / RegularMarij / AgeRegMarij",
    "HardDrugs",
    "SexEver / SexAge / SexNumPartnLife / SexNumPartYear / SameSex / SexOrientation"
  ),
  
  Descricao = c(
    # Identifica√ß√£o
    "Ano da pesquisa em que o participante foi inclu√≠do.",
    "Identificador √∫nico do participante.",
    
    # Demogr√°ficas
    "Sexo do participante (masculino ou feminino).",
    "Idade em anos no momento da triagem (80 anos ou mais registrados como 80).",
    "Categoria et√°ria por d√©cadas (0‚Äì9, 10‚Äì19, ..., 70+).",
    "Idade em meses (detalhada para algumas faixas et√°rias).",
    "Ra√ßa ou etnia informada (Mexicano, Hisp√¢nico, Branco, Negro, Asi√°tico, Outro).",
    "N√≠vel educacional (Fundamental, Ensino M√©dio, Faculdade, etc.).",
    "Estado civil (Casado, Vi√∫vo, Divorciado, Solteiro, etc.).",
    "Faixa e valor m√©dio da renda familiar anual (em d√≥lares).",
    "Raz√£o entre renda familiar e linha de pobreza.",
    "N√∫mero de c√¥modos e tipo de posse da moradia (pr√≥pria, alugada ou outra).",
    
    # Medidas F√≠sicas
    "Peso corporal em quilogramas.",
    "Altura em p√© ou comprimento deitado em cent√≠metros.",
    "Circunfer√™ncia da cabe√ßa em cent√≠metros.",
    "√çndice de Massa Corporal (IMC).",
    "Categorias de IMC conforme idade ou classifica√ß√£o da OMS.",
    "Frequ√™ncia card√≠aca e m√©dias da press√£o arterial sist√≥lica e diast√≥lica.",
    "Leituras consecutivas da press√£o arterial sist√≥lica e diast√≥lica.",
    "N√≠vel de testosterona total (ng/dL).",
    
    # Sa√∫de
    "Colesterol HDL direto e colesterol total (mmol/L).",
    "Volume e fluxo urin√°rio (mL e mL/min).",
    "Diagn√≥stico de diabetes e idade ao diagn√≥stico.",
    "Autoavalia√ß√£o geral da sa√∫de.",
    "N√∫mero de dias com sa√∫de f√≠sica ou mental ruim nos √∫ltimos 30 dias.",
    "Sintomas de depress√£o ou falta de interesse.",
    "Hist√≥rico reprodutivo.",
    "Padr√µes e dificuldades relacionadas ao sono.",
    
    # Estilo de Vida
    "Pr√°tica de atividades f√≠sicas e n√∫mero de dias por semana.",
    "Tempo m√©dio di√°rio assistindo TV ou usando computador/jogos.",
    "Consumo de √°lcool (frequ√™ncia e quantidade).",
    "H√°bito de fumar e idade de in√≠cio.",
    "Uso de maconha e idade de in√≠cio ou uso regular.",
    "Uso de drogas pesadas (coca√≠na, hero√≠na, etc.).",
    "Hist√≥rico e comportamento sexual."
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(dicionario_variaveis, 35))

```

## {diet} MASS
Dados sobre Dieta e Cora√ß√£o

### Descri√ß√£o

O data frame diet possui 337 linhas e 14 colunas. Os dados dizem respeito a uma subamostra de indiv√≠duos extra√≠da de estudos de coorte maiores sobre a incid√™ncia de doen√ßas card√≠acas  coronarianas (CHD ‚Äî Coronary Heart Disease). Esses indiv√≠duos completaram uma pesquisa
diet√©tica de sete dias com pesagem dos alimentos, enquanto participavam de estudos de valida√ß√£o de m√©todos de question√°rios alimentares. Ap√≥s o encerramento da MRC Social Medicine Unit, de onde esses estudos eram conduzidos, constatou-se que 46 eventos de CHD haviam ocorrido nesse grupo ‚Äî o que possibilitou um estudo fortuito sobre a rela√ß√£o entre dieta e incid√™ncia de doen√ßas card√≠acas coronarianas.

### Vari√°veis do estudo

```{r, echo=FALSE}

dicionario_chd <- data.frame(
  Variavel = c(
    "id",
    "doe",
    "dox",
    "dob",
    "y",
    "fail",
    "job",
    "month",
    "energy",
    "height",
    "weight",
    "fat",
    "fibre",
    "energy.grp",
    "chd"
  ),
  
  Tipo = c(
    "Num√©rico",
    "Data",
    "Data",
    "Data",
    "Num√©rico",
    "Num√©rico",
    "Fator",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Fator",
    "Num√©rico"
  ),
  
  Descricao = c(
    "Identificador do participante.",
    "Data de entrada no estudo de acompanhamento.",
    "Data de sa√≠da do estudo de acompanhamento.",
    "Data de nascimento do participante.",
    "N√∫mero de anos em risco.",
    "Status na sa√≠da do estudo (c√≥digos 1, 3 e 13 representam eventos de CHD).",
    "Ocupa√ß√£o do participante (Driver = motorista, Conductor = cobrador, Bank worker = banc√°rio).",
    "M√™s da pesquisa diet√©tica.",
    "Ingest√£o total de energia (kCal por dia / 100).",
    "Altura em cent√≠metros.",
    "Peso em quilogramas.",
    "Ingest√£o de gordura (10 g/dia).",
    "Ingest√£o de fibras alimentares (10 g/dia).",
    "Grupo de consumo energ√©tico di√°rio (‚â§2750 KCal ou >2750 KCal).",
    "Ocorr√™ncia de evento coronariano (1 = evento CHD, 0 = sem evento)."
  ),
  
  stringsAsFactors = FALSE
)


knitr::kable(head(dicionario_chd, 20))

```

Os dados foram descritos e amplamente utilizados por Clayton e Hills em Statistical Models in Epidemiology (Oxford University Press, Oxford, 1993). Eles foram resgatados da destrui√ß√£o por David Clayton e reintroduzidos a partir de impress√µes em papel.

## {Epi} DMepi
Taxas epidemiol√≥gicas de diabetes na Dinamarca (1996‚Äì2015)

### Descri√ß√£o

Contagens e anos-pessoa baseados em registros para a incid√™ncia de diabetes e mortalidade com e
sem diabetes.

### Vari√°veis do estudo
Um data frame com 4.200 observa√ß√µes sobre as seguintes 8 vari√°veis

```{r, echo=FALSE}

dicionario_diabetes <- data.frame(
  Variavel = c(
    "sex",
    "A",
    "P",
    "X",
    "D.nD",
    "Y.nD",
    "D.DM",
    "Y.DM"
  ),
  
  Tipo = c(
    "Fator",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico",
    "Num√©rico"
  ),
  
  Descricao = c(
    "Sexo do indiv√≠duo (M = masculino, F = feminino).",
    "Classe et√°ria (0‚Äì99 anos).",
    "Ano do calend√°rio (1996‚Äì2016).",
    "N√∫mero de novos diagn√≥sticos de diabetes entre pessoas sem diabetes.",
    "N√∫mero de mortes entre pessoas sem diabetes.",
    "Anos-pessoa entre pessoas sem diabetes.",
    "N√∫mero de mortes entre pessoas com diabetes.",
    "Anos-pessoa entre pessoas com diabetes."
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(dicionario_diabetes, 20))

```

Os dados s√£o baseados em registros da popula√ß√£o dinamarquesa. Inclu√≠dos apenas para fins ilustrativos, n√£o podendo ser usados como dados cientificamente validados, pois n√∫meros pequenos foram aleatoriamente permutados entre as unidades.

# Anexo: Atividades extras e desafios

**QUEST√ÉO 1**<br>
Qual a diferen√ßa entre os dois c√≥digos abaixo?
```{r, eval=FALSE}
# C√ìDIGO 1
4 / 2

```

```{r, eval=FALSE}
# CODIGO 2
divisao <- 4 / 2

```

**QUEST√ÉO 2**<br>
Escreva um c√≥digo que guarde em um objeto chamado
nome uma string com seu nome completo.

**QUEST√ÉO 3**<br>
Escreva um c√≥digo, seguindo as orienta√ß√µes abaixo. 
Crie um objeto chamado segredo que vai guardar um n√∫mero inteiro de 0 a 10. Sem olhar qual n√∫mero foi guardado no objeto, resolva:

* Verifique se o segredo √© maior ou igual a 0;
* Verifique se o segredo √© menor ou igual a 10;
* Verifique se o segredo √© maior que 5;
* Verifique se o segredo * 5 √© maior que a sua
idade;
* Qual o valor guardado no objeto segredo?

**QUEST√ÉO 4**<br>
Escreva um c√≥digo seguindo o passo a passo abaixo:

* Crie um objeto que guarde a informa√ß√£o de sua sua idade;
* Multiplique sua idade por 12 e guarde o valor num objeto chamado idade_em_meses;
* Agora multiplique sua idade em meses por 30 para obter sua idade em dias e salve o resultado no objeto idade_em_dias

**QUEST√ÉO 5**<br>
Explique por que o c√≥digo abaixo resulta num erro.

```{r, eval=FALSE}

meu - objeto <- 1

```

**QUEST√ÉO 6**<br>
Procure na Internet qual √© o ‚Äún√∫mero de ouro‚Äù e na sequ√™ncia calcule ele usando o comando function() no R.

```{r, eval=FALSE}

# Selecione 5 f√≥rmulas muito utilizadas na gradua√ß√£o, ou na sua viv√™ncia profissional, ou que seja afim √† sua √°rea de pesquisa e a esboce no R usando de fun√ß√µes como o function(), cat(), os operadores l√≥gicos e matem√°ticos, e estruturas condicionais.

```

**QUEST√ÉO 7**<br>
Por que √© prefer√≠vel escrevermos sempre o nosso c√≥digo no script e n√£o no Console?

**QUEST√ÉO 8**<br>
Marque verdadeiro ou falso para as quest√µes que seguem
<br>

```{r, echo=FALSE}

df_afirmacoes <- data.frame(
  Item = 1:8,
  Afirmacao = c(
    "Ao criar um vetor chamado tempo com os valores de minutos gastos para chegar a cada unidade de coleta ‚Äî por exemplo, tempo <- c(18, 14, 14, 15, 14, 34, 16, 17, 21, 26) ‚Äî √© poss√≠vel calcular o tempo m√°ximo, m√≠nimo e m√©dio das visitas usando as fun√ß√µes max(), min() e mean().",
    
    "Se o valor 34 do vetor tempo for um erro de digita√ß√£o e o correto for 15, √© necess√°rio digitar todos os valores novamente no R.",
    
    "O uso de colchetes [ ] permite modificar apenas um valor espec√≠fico dentro de um vetor j√° existente, sem precisar recri√°-lo.",
    
    "Ao executar x <- c(1,3,5,7,9) e y <- c(2,3,5,7,11,13), o R impedir√° qualquer opera√ß√£o entre x e y porque eles t√™m comprimentos diferentes.",
    
    "O c√°lculo de m√≥dulo, como em abs(23 - 3 * 2), pode representar diferen√ßas absolutas de valores, por exemplo, diferen√ßas entre medidas de press√£o arterial em duas consultas.",
    
    "A simula√ß√£o de jogadas de dado com sample(1:6, 25, replace = TRUE) pode representar a gera√ß√£o aleat√≥ria de dados em um experimento ou simula√ß√£o de probabilidades em sa√∫de.",
    
    "Dado o vetor temp <- c(9, 0, 10, 13, 15, 17, 18, 17, 22, 11, 15), √© poss√≠vel aplicar transforma√ß√µes matem√°ticas como sqrt(temp), log(temp), log(temp+1) e temp^2, √∫teis para normalizar dados de temperatura corporal ou valores de exames.",
    
    "Um objeto do tipo info pode armazenar informa√ß√µes pessoais e antropom√©tricas de um indiv√≠duo, como nome, idade, altura e peso, bastando criar info <- c(\"Nome\", idade, altura, peso, \"email\", \"telefone\")."
  ),
  stringsAsFactors = FALSE
)

```   

```{r, echo=FALSE}

# DIGITE

knitr::kable(head(df_afirmacoes))

```     


**QUEST√ÉO 9**<br>
Use a fun√ß√£o rnorm() para gerar dois conjuntos de dados aleat√≥rios com 100 valores e fa√ßa um gr√°fico plotando um dos conjuntos contra o outro. Existem milhares de outros comandos para alterar a apar√™ncia de gr√°ficos, veja esta p√°gina do help (?par) para ver alguns comandos sobre como alterar a apar√™ncia de gr√°ficos. N√£o se preocupe se voc√™ ficar confuso sobre as op√ß√µes do help(par), apenas praticando voc√™ ir√° come√ßar a dominar estes comandos. Coloque um t√≠tulo no gr√°fico Use Bolinhas cheias e azuis como s√≠mbolo. Coloque as legendas no eixo-x e no eixo-y. O padr√£o do R √© fazer uma ‚Äúcaixa‚Äù em torno do gr√°fico, fa√ßa uma altera√ß√£o para que apare√ßa apenas as linhas do eixo-x e do eixo-y. veja bty em ?par

**QUEST√ÉO 10**<br>
Marque verdadeiro ou falso para as quest√µes que seguem
<br>
```{r, echo=FALSE}

df_afirmacoes_2 <- data.frame(
  Item = 1:6,
  Afirmacao = c(
    "A fun√ß√£o length() permite verificar o n√∫mero de observa√ß√µes em um vetor, o que √© √∫til para saber, por exemplo, quantas amostras foram coletadas em um determinado estudo.",
    
    "As fun√ß√µes union(), intersect() e setdiff() podem ser usadas em R para comparar listas de pacientes de duas unidades de sa√∫de, encontrando nomes que aparecem em ambas (interse√ß√£o), em apenas uma (diferen√ßa) ou em qualquer uma delas (uni√£o) em um estudo.",
    
    "A fun√ß√£o rep() √© √∫til para criar vetores que repetem categorias, como 5 amostras da ‚ÄúUnidade A‚Äù e 5 da ‚ÄúUnidade B‚Äù, em estudos comparativos de ambientes ou popula√ß√µes.",
    
    "A fun√ß√£o sample() pode ser usada para selecionar aleatoriamente amostras de pacientes ou unidades de sa√∫de, simulando uma amostragem probabil√≠stica, como em um sorteio de n√∫meros da Mega-Sena.",
    
    "Para criar uma sequ√™ncia apenas com n√∫meros √≠mpares de 1 a 30, pode-se usar seq(1, 30, by = 2). Essa fun√ß√£o √© √∫til para gerar identificadores ordenados de pacientes ou visitas em estudos.",
    
    "Ao fechar o R com o comando q(), o programa pergunta se deseja salvar o ambiente de trabalho (workspace). Caso o usu√°rio salve, os objetos criados podem ser verificados ap√≥s reabrir o R com ls()."
  ),
  stringsAsFactors = FALSE
)


```   

```{r, echo=FALSE}

# DIGITE

knitr::kable(head(df_afirmacoes_2))

```     

## Desafios {.tabset .tabset-fade}

Cf. Nota dos autores sobre os respectivos desafios [^2]

[^2]: Para ter acesso integral aos dados desses respectivos desafios entre em contato com os autores dessa apostila. 

### Op√ß√£o 1

```{r, echo=FALSE}

tabela_plano_analise <- data.frame(
  Topico = c(
    "Tema",
    "Banco de Dados",
    "Objetivo da An√°lise",
    "Instru√ß√µes R",
    "Links √∫teis"
  ),
  
  Detalhe = c(
    "Perfil Antropom√©trico e de Risco de Doen√ßas em Escolares",
    
    "PeNSE (Pesquisa Nacional de Sa√∫de do Escolar) - IBGE (Dados sobre peso, altura, estilo de vida e consumo alimentar de escolares).",
    
    "Descrever o estado nutricional (IMC) de adolescentes e comparar a frequ√™ncia de consumo de alimentos n√£o saud√°veis entre aqueles com e sem excesso de peso.",
    
    "Prepara√ß√£o/Objetos: importa√ß√£o, limpeza e prepara√ß√£o do banco para a an√°lise (verifique se as colunas est√£o nos formatos adequados e se o tipo de dado √© condizente com o objetivo); Codifica√ß√£o/L√≥gica: Use operadores l√≥gicos (if_else ou ifelse) para criar uma vari√°vel bin√°ria (0/1) indicando o consumo regular de refrigerante; Estat√≠stica Descritiva: Calcule a propor√ß√£o de adolescentes acima do peso que consomem regularmente refrigerante e que n√£o consomem; Visualiza√ß√£o: Gere um gr√°fico de barras mostrando a propor√ß√£o de consumo de alimentos ultraprocessados por estado nutricional.",
    
    "https://www.ibge.gov.br/estatisticas/sociais/educacao/9134-pesquisa-nacional-de-saude-do-escolar.html"
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(tabela_plano_analise))

```  

### Op√ß√£o 2

```{r, echo=FALSE}

tabela_plano_sisvan <- data.frame(
  Topico = c(
    "Tema",
    "Banco de Dados",
    "Objetivo da An√°lise",
    "Instru√ß√µes R"
  ),
  
  Detalhe = c(
    "An√°lise da Cobertura de Vigil√¢ncia Alimentar e Nutricional (SISVAN)",
    
    "SISVAN (Sistema de Vigil√¢ncia Alimentar e Nutricional) - Banco simulado",
    
    "Explorar e Manipular os dados de avalia√ß√£o antropom√©trica, calculando a cobertura e identificando discrep√¢ncias na distribui√ß√£o et√°ria da popula√ß√£o acompanhada.",
    
    "Pacotes/Importa√ß√£o: Instale e carregue o banco para acessar os dados (verifique se as colunas est√£o nos formatos adequados e se o tipo de dado √© condizente com o objetivo); Fun√ß√µes: Crie uma fun√ß√£o que receba a Idade e retorne a fase da vida (\"Crian√ßa\", \"Adolescente\", \"Adulto\", \"Idoso\"); Manipula√ß√£o de Dados: Aplique a fun√ß√£o criada para classificar a popula√ß√£o e use o resultado para criar um data.frame resumo que mostre a contagem de indiv√≠duos por faixa et√°ria em cada regi√£o"
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(tabela_plano_sisvan))

```  

### Op√ß√£o 3

```{r, echo=FALSE}

tabela_plano_sinasc <- data.frame(
  Topico = c(
    "Tema",
    "Banco de Dados",
    "Objetivo da An√°lise",
    "Instru√ß√µes R"
  ),
  
  Detalhe = c(
    "Fatores Associados √† Mortalidade Infantil",
    
    "SINASC (Sistema de Informa√ß√µes sobre Nascidos Vivos) - DATASUS (Dados sobre nascimentos, incluindo peso ao nascer, idade gestacional e caracter√≠sticas maternas).",
    
    "Modelar a rela√ß√£o entre o peso ao nascer (vari√°vel resposta) e fatores maternos (e.g., idade da m√£e, n√∫mero de consultas de pr√©-natal), e visualizar essas rela√ß√µes.",
    
    "Data Handling: Filtre o conjunto de dados para uma regi√£o ou faixa et√°ria materna espec√≠fica (e.g., m√£es com menos de 18 anos); Regress√£o Simples: Realize a An√°lise de Regress√£o Linear Simples do Peso ao Nascer pela Idade da M√£e; Regress√£o M√∫ltipla: Construa o modelo de Regress√£o Linear M√∫ltipla utilizando: Peso ao Nascer (Idade da M√£e + N√∫mero de Consultas Pr√©-natal + Tipo de Parto); An√°lise do Modelo: Interprete o coeficiente de regress√£o para o N√∫mero de Consultas Pr√©-natal, e avalie a signific√¢ncia estat√≠stica; Visualiza√ß√£o: Crie um gr√°fico de dispers√£o mostrando a rela√ß√£o Peso ao Nascer vs. N√∫mero de Consultas, colorindo os pontos pelo Tipo de Parto"
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(tabela_plano_sinasc))

``` 


### Op√ß√£o 4

```{r, echo=FALSE}

tabela_plano_pns <- data.frame(
  Topico = c(
    "Tema",
    "Banco de Dados",
    "Objetivo da An√°lise",
    "Instru√ß√µes R"
  ),
  
  Detalhe = c(
    "Distribui√ß√£o de Risco Nutricional e Doen√ßas Cr√¥nicas por Regi√£o Geogr√°fica em Idosos",
    
    "PNS (Pesquisa Nacional de Sa√∫de) - IBGE (Dados sobre condi√ß√µes de sa√∫de, antropometria, h√°bitos alimentares e n√≠vel de atividade f√≠sica, com foco na popula√ß√£o idosa).",
    
    "Quantificar a preval√™ncia de duas condi√ß√µes de risco (Baixo Consumo de Frutas/Hortali√ßas e Sedentarismo) e descrever como a co-ocorr√™ncia dessas condi√ß√µes varia entre as grandes Regi√µes Brasileiras.",
    
    "Data Handling e L√≥gica: Filtre o dataset para incluir apenas indiv√≠duos com 60 anos ou mais e crie uma vari√°vel categ√≥rica bin√°ria (Risco_Nutricional) utilizando operadores l√≥gicos para classificar indiv√≠duos com IMC < 22; Cria√ß√£o de Vari√°vel Composta: Crie uma nova vari√°vel chamada Risco_Comportamental que assuma o valor \"Sim\" quando o indiv√≠duo for sedent√°rio E apresentar baixo consumo de frutas/hortali√ßas; Tabula√ß√£o: Calcule a preval√™ncia do Risco_Comportamental por Grande Regi√£o do Brasil; Visualiza√ß√£o: Construa um gr√°fico (por exemplo, gr√°fico de barras) que permita comparar visualmente a distribui√ß√£o do risco comportamental entre as regi√µes."
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(tabela_plano_pns))

```


### Op√ß√£o 5

```{r, echo=FALSE}

tabela_plano_vigitel <- data.frame(
  Topico = c(
    "Tema",
    "Banco de Dados",
    "Objetivo da An√°lise",
    "Instru√ß√µes R"
  ),
  
  Detalhe = c(
    "An√°lise Longitudinal Simplificada: Mudan√ßa na Preval√™ncia de Excesso de Peso ao Longo do Tempo (4 Anos)",
    
    "VIGITEL (S√©rie Hist√≥rica) - Minist√©rio da Sa√∫de (Dados de diferentes anos, por exemplo, 2019 a 2023, das capitais brasileiras, incluindo a vari√°vel categ√≥rica Excesso de Peso e informa√ß√µes sobre Consumo de √Ålcool).",
    
    "Rastrear a tend√™ncia da preval√™ncia de excesso de peso em duas regi√µes distintas (por exemplo, Sul e Norte) ao longo de 5 anos e comparar a m√©dia de consumo de √°lcool entre essas regi√µes.",
    
    "Data Handling (Unifica√ß√£o): Importe e una os 4 datasets anuais do VIGITEL em um √∫nico data.frame utilizando uma fun√ß√£o de uni√£o de linhas, como rbind() ou bind_rows(); Estat√≠stica Descritiva e Estrutura de Repeti√ß√£o: Utilize uma estrutura de repeti√ß√£o (for ou lapply) para calcular a preval√™ncia de Excesso de Peso separadamente para cada um dos 5 anos; Compara√ß√£o Regional: Calcule a m√©dia de consumo de √°lcool para as Regi√µes Sul e Norte; Visualiza√ß√£o: Crie um gr√°fico de linhas que mostre a evolu√ß√£o da preval√™ncia de Excesso de Peso ao longo dos 4 anos, com uma linha representando a Regi√£o Sul e outra a Regi√£o Norte."
  ),
  
  stringsAsFactors = FALSE
)

knitr::kable(head(tabela_plano_vigitel))

```


# Refer√™ncias, notas e materiais de apoio

1. [ANJOS, Adilson dos. Estat√≠stica b√°sica com uso do software R. Curitiba: Departamento de Estat√≠stica ‚Äì UFPR, 2010.](https://docs.ufpr.br/~aanjos/TRI/R/rbasico.pdf)

2. [BOLFARINE, Heleno; SANDOVAL, M√¥nica Carneiro. Introdu√ß√£o √† infer√™ncia estat√≠stica. S√£o Paulo: Blucher, 2018.](https://docs.ufpr.br/~lucambio/CE210/LIVRO%20de%20infer%EAncia%20bolfarine.pdf)

3. [CASELLA, George; BERGER, Roger L. Statistical inference. 2nd ed. Belmont, CA: Duxbury Press, 2002.](https://www.amazon.com.br/Statistical-Inference-George-Casella/dp/1032593032/ref=sr_1_1?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&crid=32UCM6L87P7E1&dib=eyJ2IjoiMSJ9.Ax3SRemiZDkg6JQcCEjJyvkHFeo9-o-Z8AwK3hLco-p9p1QN5dOVAGYp-1RLcf0wX5z0QLCKtHCJXsXauosVYrzAX5WOG4kYqeJPoTC-M9U8evy8ED_8XzKushqfNV4-0qSUPZJoSDMvHHf9QgkfYZfShcnEblFie46_09JPowIsR77rDAaw3oHsj0MwLZxl.G8t2XqvTavTKwvfQPgVAJ4QK2bSzEZiEhoypCq-SWDI&dib_tag=se&keywords=Statistical+Inference+ByGeorge+Casella%2C+Roger+Berger&qid=1761863452&sprefix=statistical+inference+bygeorge+casella+roger+berger%2Caps%2C229&sr=8-1&ufe=app_do%3Aamzn1.fos.4bddec23-2dcf-4403-8597-e1a02442043d)

4. [CHAOUBAH, A. A import√¢ncia da Bioestat√≠stica na forma√ß√£o de um profissional de Sa√∫de. Revista Brasileira de Oftalmologia](https://www.scielo.br/j/rbof/a/ZnvJ63VgxhbhWthX9nVBWgg/?format=html&lang=pt)

5. [Correa, S. M. B. B. (2003). Probabilidade e estat√≠stica.](https://d1wqtxts1xzle7.cloudfront.net/40496861/livro_probabilidade_estatistica_2a_ed-libre.pdf?1448876315=&response-content-disposition=inline%3B+filename%3DLivro_texto_de_Probabilidade_e_Estatisti.pdf&Expires=1768007441&Signature=Ew5ysdtztFVdPGD9rBU-jJFIlRQlwIkt1-xvU9sUgOlIahl99Jv88SDSjq6iBqSSKf4SuA0SDT1~lGU6D-OdmqgHC8l822eHlQBr9XtHpWvQWtaa5~qYfoK2JYIdDAyFxABfmgd6T3vrNHu5lTEgxw2Nkis7I8e91dfxzt61CqZGDbTK3EH8yfwDFy8ci6jUDajPxFQFlEKHANeBNRxLC~O4CsuOnvuQZYgw7PHVi33E1C17eudUXXSMA1VByE96myzok8RGTegetxZal7MaNCC8I-byQBlm9zEDLJGTS0pOL1nhiR-fnmZV2osCsHi6lq83cWcOEo-foJgafuuxlA__&Key-Pair-Id=APKAJLOHF5GGSLRBV4ZA)

6. [Curso: Ci√™ncia de Dados em R](https://livro.curso-r.com/index.html)

7. [Figueiredo Filho, Dalson, et al. "O que fazer e o que n√£o fazer com a regress√£o: pressupostos e aplica√ß√µes do modelo linear de M√≠nimos Quadrados Ordin√°rios (MQO)." Revista Pol√≠tica Hoje 20.1 (2011): 44-99.](https://www.academia.edu/8169376/O_que_Fazer_e_o_que_N%C3%A3o_Fazer_com_a_Regress%C3%A3o_pressupostos_e_aplica%C3%A7%C3%B5es_do_modelo_linear_de_M%C3%ADnimos_Quadrados_Ordin%C3%A1rios_MQO)

8. [Grolemund, Garrett. Hands-on programming with R. " O'Reilly Media, Inc.", 2014.](https://rstudio-education.github.io/hopr/basics.html)

9. [Hadley Wickham (2010): Uma gram√°tica em camadas de gr√°ficos, Journal of Computational and Graphical Statistics](https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf)

10. [JAMES, Gareth et al. An Introduction to Statistical Learning: with Applications in R. Second Edition. (S.l.):¬†(s.n.),¬†2023.](https://www.statlearning.com/)

11. [Kuhn, Max, and Julia Silge. Tidy modeling with R: A framework for modeling in the tidyverse. " O'Reilly Media, Inc.", 2022.](https://www.tmwr.org/)

12. [LANDEIRO, Victor Lemes. Introdu√ß√£o ao uso do programa R. Manaus: Instituto Nacional de Pesquisas da Amaz√¥nia, Programa de P√≥s-Gradua√ß√£o em Ecologia](https://cran.r-project.org/doc/contrib/Landeiro-Introducao.pdf)

13. MARTIN, Peter. Linear Regression: an introduction to statistical models. London: SAGE Publications, 2021. 978-1-5264-2417-4. (The SAGE Quantitative Research Kit).

14. [The R Graph Gallery (Site para ver modelos de poss√≠veis gr√°ficos no R)](https://r-graph-gallery.com/index.html)

15. [Wickham H (2014). Dados organizados. Journal of Statistical Software. Volume 59, Edi√ß√£o 10.](https://vita.had.co.nz/papers/tidy-data.pdf)

16. [Wickham, Hadley, Mine √áetinkaya-Rundel, and Garrett Grolemund. R f√ºr Data Science: Daten importieren, bereinigen, umformen und visualisieren. O'Reilly, 2024.](https://pt.r4ds.hadley.nz/)

17. Mais informa√ß√µes podem ser encontradas em [tidyverse.org](https://tidyverse.org/)

Mais informa√ß√µes sobre **Regress√£o Linear** na √°rea de **Nutri√ß√£o e Sa√∫de** podem sem encontradas abaixo

18. [Costa et tal. Evolu√ß√£o do excesso de peso e fatores associados em mulheres de 10 a 49 anos em Pernambuco, Nordeste, Brasil. Revista de Nutri√ß√£o](https://www.scielo.br/j/rn/a/4SnTxv5qmCP4kjgPRNBN3QC/?lang=pt)

19. [Pinho et tal. Excesso de peso em adultos do Estado de Pernambuco, Brasil: magnitude e fatores associados. Cadernos de Sa√∫de P√∫blica¬¥](https://www.scielo.br/j/csp/a/yVJSvdS5Xptjh3dHZL4c7GS/?lang=pt)

20. [Silva et tal. Situa√ß√£o de inseguran√ßa alimentar em domic√≠lios de Pernambuco, Regi√£o Nordeste do Brasil: contribui√ß√µes para discuss√£o da viola√ß√£o do direito √† alimenta√ß√£o. Sa√∫de e Sociedade](https://www.scielo.br/j/sausoc/a/MJNKgg3CTPMLt8DMm3RwjQH/abstract/?lang=pt)

<br>
<a href="https://github.com/ryallmeida/r_p_saude/blob/main/LICENSE"
   target="_blank"
   rel="noopener noreferrer">
  <img
    src="https://raw.githubusercontent.com/ryallmeida/r_p_saude/main/modulos/img/mit_license.jpeg"
    alt="MIT License"
    height="50"
  />
</a>
<br>

![](https://raw.githubusercontent.com/ryallmeida/r_p_saude/main/modulos/img/realizacao.png){width=544px, .center}
